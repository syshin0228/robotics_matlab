% This code is programmed by Sung Yul Shin (syshin0228@utexas.edu) for Robotics Modeling and Control course by Dr. James Sulzer from University of Texas at Austin 
clc
clear all
close all

% Simulate Forward Dynamics of 3 DoF RRP Manipulator 
% Apply Inverse Dynamics Control

% Angle coversion
deg2rad = pi/180;
rad2deg = 180/pi;

% Sampling rate info
Hz = 1000;
dt = 1/Hz;

% System Parameters
L1 = 1.0;       % Link1 length
L2 = 1.0;       % Link2 length
L1c = 0.5;      % Link1 CoM length
L2c = 0.5;      % Link2 CoM length
m1 = 1;         % Mass 1
m2 = 1;         % Mass 2
m3 = 1;         % Mass 3
I1 = 1;         % Moment of inertia of link 1
I2 = 1;         % Moment of inertia of link 2
I3 = 1;         % Moment of inertia of link 3
g = 9.81;       % Gravity acceleration
B = 0;          % Damping coefficient

% Simulation time
t0 = 0.0;                   % Initial time
tf = 3.0;                   % Final time
time = [t0:1:tf*Hz]*dt;     % Time

% Control Gain
w = [10 10 10]';
zeta = 1.0;
Kp = [w(1)^2 w(2)^2 w(3)^2]';
Kd = zeta*[2*w(1) 2*w(2) 2*w(3)]';

% Desired step input
th_d12 = [30 45] * deg2rad;
ddth_d12 = [0 0] * deg2rad;
th_d3 = [1.0];
ddth_d3 = 0;
th_d = [th_d12 th_d3]';
ddth_d = [ddth_d12 ddth_d3]';

% Forward Dynamics Simulation
% Initialization
th = [0 0 0]';
dth = [0 0 0]';
ddth = [0 0 0]';
for i = 1:1:length(time)
    
    t = time(i);
    
    % Current variables (joint positions, joint velocities)
    q1 = th(1);
    q2 = th(2);
    q3 = th(3);
    dq1 = dth(1);
    dq2 = dth(2);
    dq3 = dth(3);
    
    % Control Input
    % Outer Loop Controller
    a_q(1) = ddth_d(1) -Kd(1)*dq1 + Kp(1)*(th_d(1) - q1);
    a_q(2) = ddth_d(2) -Kd(2)*dq2 + Kp(2)*(th_d(2) - q2);
    a_q(3) = ddth_d(3) -Kd(3)*dq3 + Kp(3)*(th_d(3) - q3);
    
    % Inner Loop Controller
    ddq1 = a_q(1);
    ddq2 = a_q(2);
    ddq3 = a_q(3);
    
    u(1) = I1*ddq1 + I2*ddq1 + (4967757600021511*I2*ddq2)/81129638414606681695789005144064 + I3*ddq1 + (4967757600021511*I3*ddq2)/81129638414606681695789005144064 + (6582018229284824168619876730229476055777661176982921856382605459*ddq1*m3*q3^2)/13164036458569648337239753460458804039861886925068638906788872192 + (65395742164019627244910439980703010190002589707249088214360677901900957066777943*ddq2*m3*q3^2)/1067993517960455041197510853084776057301352261178326384973520803911109862890320275011481043468288 + (6582018229284824168619876730229476055777661176982921856382605459*L2c^2*ddq1*m3)/13164036458569648337239753460458804039861886925068638906788872192 + (65395742164019627244910439980703010190002589707249088214360677901900957066777943*L2c^2*ddq2*m3)/1067993517960455041197510853084776057301352261178326384973520803911109862890320275011481043468288 + (6582018229284824168619876730229476055777661176982921856382605459*dq1*dq3*m3*q3)/6582018229284824168619876730229402019930943462534319453394436096 + (65395742164019627244910439980703010190002589707249088214360677901900957066777943*dq2*dq3*m3*q3)/533996758980227520598755426542388028650676130589163192486760401955554931445160137505740521734144 + (6582018229284824168619876730229377341315370891051451985731712975*L2c^2*ddq1*m3*cos(2*q2))/13164036458569648337239753460458804039861886925068638906788872192 - (122597380068651197257713859414983140362437055831*L2c^2*ddq2*m3*cos(2*q2))/1067993517960455041197510853084776057301352261178326384973520803911109862890320275011481043468288 - (32697871082009813622455219990351566393691329179223172964110046442520659751916887*L2c^2*dq2^2*m3*cos(q2))/533996758980227520598755426542388028650676130589163192486760401955554931445160137505740521734144 + (6582018229284824168619876730229377341315370891051451985731712975*ddq1*m3*q3^2*cos(2*q2))/13164036458569648337239753460458804039861886925068638906788872192 - (122597380068651197257713859414983140362437055831*ddq2*m3*q3^2*cos(2*q2))/1067993517960455041197510853084776057301352261178326384973520803911109862890320275011481043468288 - (32697871082009813622455219990351566393691329179223172964110046442520659751916887*dq2^2*m3*q3^2*cos(q2))/533996758980227520598755426542388028650676130589163192486760401955554931445160137505740521734144 + (122597380068651197257713859414983140362437055831*L2c^2*dq2^2*m3*sin(2*q2))/533996758980227520598755426542388028650676130589163192486760401955554931445160137505740521734144 + (122597380068651197257713859414983140362437055831*dq2^2*m3*q3^2*sin(2*q2))/533996758980227520598755426542388028650676130589163192486760401955554931445160137505740521734144 - (24678615572571482867467662723121*L2c^2*ddq1*m3*sin(q2))/3291009114642412084309938365114701009965471731267159726697218048 - (32697871082009813622455219990351566393691329179223172964110046442520659751916887*L2c^2*ddq2*m3*sin(q2))/533996758980227520598755426542388028650676130589163192486760401955554931445160137505740521734144 + (6582018229284824168619876730229476055777661176982921856382605459*L2c*dq1*dq3*m3)/6582018229284824168619876730229402019930943462534319453394436096 + (65395742164019627244910439980703010190002589707249088214360677901900957066777943*L2c*dq2*dq3*m3)/533996758980227520598755426542388028650676130589163192486760401955554931445160137505740521734144 - (24678615572571482867467662723121*ddq1*m3*q3^2*sin(q2))/3291009114642412084309938365114701009965471731267159726697218048 - (32697871082009813622455219990351566393691329179223172964110046442520659751916887*ddq2*m3*q3^2*sin(q2))/533996758980227520598755426542388028650676130589163192486760401955554931445160137505740521734144 + (6582018229284824168619876730229476055777661176982921856382605459*L2c*ddq1*m3*q3)/6582018229284824168619876730229402019930943462534319453394436096 + (65395742164019627244910439980703010190002589707249088214360677901900957066777943*L2c*ddq2*m3*q3)/533996758980227520598755426542388028650676130589163192486760401955554931445160137505740521734144 + (6582018229284824168619876730229377341315370891051451985731712975*L2c*dq1*dq3*m3*cos(2*q2))/6582018229284824168619876730229402019930943462534319453394436096 - (122597380068651197257713859414983140362437055831*L2c*dq2*dq3*m3*cos(2*q2))/533996758980227520598755426542388028650676130589163192486760401955554931445160137505740521734144 - (24678615572571482867467662723121*L2c^2*dq1*dq2*m3*cos(q2))/3291009114642412084309938365114701009965471731267159726697218048 + (6582018229284824168619876730229377341315370891051451985731712975*L2c*ddq1*m3*q3*cos(2*q2))/6582018229284824168619876730229402019930943462534319453394436096 - (122597380068651197257713859414983140362437055831*L2c*ddq2*m3*q3*cos(2*q2))/533996758980227520598755426542388028650676130589163192486760401955554931445160137505740521734144 - (32697871082009813622455219990351566393691329179223172964110046442520659751916887*L2c*dq2^2*m3*q3*cos(q2))/266998379490113760299377713271194014325338065294581596243380200977777465722580068752870260867072 + (6582018229284824168619876730229377341315370891051451985731712975*dq1*dq3*m3*q3*cos(2*q2))/6582018229284824168619876730229402019930943462534319453394436096 - (122597380068651197257713859414983140362437055831*dq2*dq3*m3*q3*cos(2*q2))/533996758980227520598755426542388028650676130589163192486760401955554931445160137505740521734144 - (24678615572571482867467662723121*dq1*dq2*m3*q3^2*cos(q2))/3291009114642412084309938365114701009965471731267159726697218048 - (6582018229284824168619876730229377341315370891051451985731712975*L2c^2*dq1*dq2*m3*sin(2*q2))/6582018229284824168619876730229402019930943462534319453394436096 + (122597380068651197257713859414983140362437055831*L2c*dq2^2*m3*q3*sin(2*q2))/266998379490113760299377713271194014325338065294581596243380200977777465722580068752870260867072 - (6582018229284824168619876730229377341315370891051451985731712975*dq1*dq2*m3*q3^2*sin(2*q2))/6582018229284824168619876730229402019930943462534319453394436096 - (24678615572571482867467662723121*L2c*dq1*dq3*m3*sin(q2))/1645504557321206042154969182557350504982735865633579863348609024 - (32697871082009813622455219990351566393691329179223172964110046442520659751916887*L2c*dq2*dq3*m3*sin(q2))/266998379490113760299377713271194014325338065294581596243380200977777465722580068752870260867072 - (24678615572571482867467662723121*L2c*ddq1*m3*q3*sin(q2))/1645504557321206042154969182557350504982735865633579863348609024 - (32697871082009813622455219990351566393691329179223172964110046442520659751916887*L2c*ddq2*m3*q3*sin(q2))/266998379490113760299377713271194014325338065294581596243380200977777465722580068752870260867072 - (24678615572571482867467662723121*dq1*dq3*m3*q3*sin(q2))/1645504557321206042154969182557350504982735865633579863348609024 - (32697871082009813622455219990351566393691329179223172964110046442520659751916887*dq2*dq3*m3*q3*sin(q2))/266998379490113760299377713271194014325338065294581596243380200977777465722580068752870260867072 - (24678615572571482867467662723121*L2c*dq1*dq2*m3*q3*cos(q2))/1645504557321206042154969182557350504982735865633579863348609024 - (6582018229284824168619876730229377341315370891051451985731712975*L2c*dq1*dq2*m3*q3*sin(2*q2))/3291009114642412084309938365114701009965471731267159726697218048;
    u(2) = (4967757600021511*I2*ddq1)/81129638414606681695789005144064 + (6582018229284824168619876730229426698546516034017186921057159217*I2*ddq2)/6582018229284824168619876730229402019930943462534319453394436096 + (4967757600021511*I3*ddq1)/81129638414606681695789005144064 + (6582018229284824168619876730229426698546516034017186921057159217*I3*ddq2)/6582018229284824168619876730229402019930943462534319453394436096 + (65395742164019627244910439980703010190002589707249088214360677901900957066777943*ddq1*m3*q3^2)/1067993517960455041197510853084776057301352261178326384973520803911109862890320275011481043468288 + (86645927941275464361825443254471853037681375139010675115766089613653431867203651968782983950918086798894542933502663265491949921*ddq2*m3*q3^2)/86645927941275464361825443254471365732388658605494267974077486894206915868925800719999200190754361815543475342543861619655442432 - (24678615572571482867467662723121*dq3^2*m3*sin(2*q2))/13164036458569648337239753460458804039861886925068638906788872192 + (65395742164019627244910439980703010190002589707249088214360677901900957066777943*L2c^2*ddq1*m3)/1067993517960455041197510853084776057301352261178326384973520803911109862890320275011481043468288 + (86645927941275464361825443254471853037681375139010675115766089613653431867203651968782983950918086798894542933502663265491949921*L2c^2*ddq2*m3)/86645927941275464361825443254471365732388658605494267974077486894206915868925800719999200190754361815543475342543861619655442432 + (65395742164019627244910439980703010190002589707249088214360677901900957066777943*dq1*dq3*m3*q3)/533996758980227520598755426542388028650676130589163192486760401955554931445160137505740521734144 + (86645927941275464361825443254471853037681375139010675115766089613653431867203651968782983950918086798894542933502663265491949921*dq2*dq3*m3*q3)/43322963970637732180912721627235682866194329302747133987038743447103457934462900359999600095377180907771737671271930809827721216 - (122597380068651197257713859414983140362437055831*L2c^2*ddq1*m3*cos(2*q2))/1067993517960455041197510853084776057301352261178326384973520803911109862890320275011481043468288 - (162435097572177838802380562867573554861377145128882373770546480124815941848624291874514684156257*L2c^2*ddq2*m3*cos(2*q2))/86645927941275464361825443254471365732388658605494267974077486894206915868925800719999200190754361815543475342543861619655442432 + (24678615572571482867467662723121*L2c^2*dq1^2*m3*cos(q2))/6582018229284824168619876730229402019930943462534319453394436096 - (122597380068651197257713859414983140362437055831*ddq1*m3*q3^2*cos(2*q2))/1067993517960455041197510853084776057301352261178326384973520803911109862890320275011481043468288 - (162435097572177838802380562867573554861377145128882373770546480124815941848624291874514684156257*ddq2*m3*q3^2*cos(2*q2))/86645927941275464361825443254471365732388658605494267974077486894206915868925800719999200190754361815543475342543861619655442432 + (24678615572571482867467662723121*dq1^2*m3*q3^2*cos(q2))/6582018229284824168619876730229402019930943462534319453394436096 + L2c*g*m3*cos(q2) + g*m3*q3*cos(q2) + (6582018229284824168619876730229377341315370891051451985731712975*L2c^2*dq1^2*m3*sin(2*q2))/13164036458569648337239753460458804039861886925068638906788872192 + (162435097572177838802380562867573554861377145128882373770546480124815941848624291874514684156257*L2c^2*dq2^2*m3*sin(2*q2))/86645927941275464361825443254471365732388658605494267974077486894206915868925800719999200190754361815543475342543861619655442432 + (6582018229284824168619876730229377341315370891051451985731712975*dq1^2*m3*q3^2*sin(2*q2))/13164036458569648337239753460458804039861886925068638906788872192 + (162435097572177838802380562867573554861377145128882373770546480124815941848624291874514684156257*dq2^2*m3*q3^2*sin(2*q2))/86645927941275464361825443254471365732388658605494267974077486894206915868925800719999200190754361815543475342543861619655442432 - (32697871082009813622455219990351566393691329179223172964110046442520659751916887*L2c^2*ddq1*m3*sin(q2))/533996758980227520598755426542388028650676130589163192486760401955554931445160137505740521734144 + (65395742164019627244910439980703010190002589707249088214360677901900957066777943*L2c*dq1*dq3*m3)/533996758980227520598755426542388028650676130589163192486760401955554931445160137505740521734144 + (86645927941275464361825443254471853037681375139010675115766089613653431867203651968782983950918086798894542933502663265491949921*L2c*dq2*dq3*m3)/43322963970637732180912721627235682866194329302747133987038743447103457934462900359999600095377180907771737671271930809827721216 - (32697871082009813622455219990351566393691329179223172964110046442520659751916887*ddq1*m3*q3^2*sin(q2))/533996758980227520598755426542388028650676130589163192486760401955554931445160137505740521734144 + (65395742164019627244910439980703010190002589707249088214360677901900957066777943*L2c*ddq1*m3*q3)/533996758980227520598755426542388028650676130589163192486760401955554931445160137505740521734144 + (86645927941275464361825443254471853037681375139010675115766089613653431867203651968782983950918086798894542933502663265491949921*L2c*ddq2*m3*q3)/43322963970637732180912721627235682866194329302747133987038743447103457934462900359999600095377180907771737671271930809827721216 - (122597380068651197257713859414983140362437055831*L2c*dq1*dq3*m3*cos(2*q2))/533996758980227520598755426542388028650676130589163192486760401955554931445160137505740521734144 - (162435097572177838802380562867573554861377145128882373770546480124815941848624291874514684156257*L2c*dq2*dq3*m3*cos(2*q2))/43322963970637732180912721627235682866194329302747133987038743447103457934462900359999600095377180907771737671271930809827721216 - (122597380068651197257713859414983140362437055831*L2c*ddq1*m3*q3*cos(2*q2))/533996758980227520598755426542388028650676130589163192486760401955554931445160137505740521734144 - (162435097572177838802380562867573554861377145128882373770546480124815941848624291874514684156257*L2c*ddq2*m3*q3*cos(2*q2))/43322963970637732180912721627235682866194329302747133987038743447103457934462900359999600095377180907771737671271930809827721216 + (24678615572571482867467662723121*L2c*dq1^2*m3*q3*cos(q2))/3291009114642412084309938365114701009965471731267159726697218048 - (122597380068651197257713859414983140362437055831*dq1*dq3*m3*q3*cos(2*q2))/533996758980227520598755426542388028650676130589163192486760401955554931445160137505740521734144 - (162435097572177838802380562867573554861377145128882373770546480124815941848624291874514684156257*dq2*dq3*m3*q3*cos(2*q2))/43322963970637732180912721627235682866194329302747133987038743447103457934462900359999600095377180907771737671271930809827721216 + (6582018229284824168619876730229377341315370891051451985731712975*L2c*dq1^2*m3*q3*sin(2*q2))/6582018229284824168619876730229402019930943462534319453394436096 + (162435097572177838802380562867573554861377145128882373770546480124815941848624291874514684156257*L2c*dq2^2*m3*q3*sin(2*q2))/43322963970637732180912721627235682866194329302747133987038743447103457934462900359999600095377180907771737671271930809827721216 - (32697871082009813622455219990351566393691329179223172964110046442520659751916887*L2c*dq1*dq3*m3*sin(q2))/266998379490113760299377713271194014325338065294581596243380200977777465722580068752870260867072 - (32697871082009813622455219990351566393691329179223172964110046442520659751916887*L2c*ddq1*m3*q3*sin(q2))/266998379490113760299377713271194014325338065294581596243380200977777465722580068752870260867072 - (32697871082009813622455219990351566393691329179223172964110046442520659751916887*dq1*dq3*m3*q3*sin(q2))/266998379490113760299377713271194014325338065294581596243380200977777465722580068752870260867072; 
    u(3) = (m3*(43322963970637732180912721627235926518840687569505337557883044807131232966891209833975873945278205765565891037230537107299965281*ddq3 + 162435097572177838802380562867572945827310566361183205006606841800083704609483333463565576175616*g - 21661481985318866090456360813618085085743522918131770564363673082970469933080991954807309957951290579442783060636160753278124032*L2c*dq1^2 - (86645927941275464361825443254471853037681375139010675115766089613653431867203651968782983950918086798894542933502663265491949921*L2c*dq2^2)/2 - 21661481985318866090456360813618085085743522918131770564363673082970469933080991954807309957951290579442783060636160753278124032*dq1^2*q3 - (86645927941275464361825443254471853037681375139010675115766089613653431867203651968782983950918086798894542933502663265491949921*dq2^2*q3)/2 + 43322963970637732180912721627235682866194329302747133987038743447103457934462900359999600095377180907771737671271930809827721216*g*sin(q2) - 81217548786088919401190281433786472913655283180591602503303420900041852304741666731782788087808*ddq3*cos(2*q2) + 324870195144355677604761125735145891654621132722366410013213683600167409218966666927131152351232*L2c*dq1^2*sin(q2) + 162435097572177838802380562867572945827310566361183205006606841800083704609483333463565576175616*dq2*dq3*sin(2*q2) - 5305532915621760638932094989885589305198650351294141888575215604290738819910811175157743538537785994785012580352*L2c*dq1*dq2 + 324870195144355677604761125735145891654621132722366410013213683600167409218966666927131152351232*dq1^2*q3*sin(q2) - 5305532915621760638932094989885589305198650351294141888575215604290738819910811175157743538537785994785012580352*dq1*dq2*q3 - 21661481985318866090456360813617760215548378562454165803237937937078815311948269588397296744267690412033564093969233622125772800*L2c*dq1^2*cos(2*q2) + (162435097572177838802380562867573554861377145128882373770546480124815941848624291874514684156257*L2c*dq2^2*cos(2*q2))/2 - 21661481985318866090456360813617760215548378562454165803237937937078815311948269588397296744267690412033564093969233622125772800*dq1^2*q3*cos(2*q2) + (162435097572177838802380562867573554861377145128882373770546480124815941848624291874514684156257*dq2^2*q3*cos(2*q2))/2 + 5305532915621760638932094989885599251479765899073858534427490457326786488000343953432478356694281949855178817536*L2c*dq1*dq2*sin(q2) + 5305532915621760638932094989885599251479765899073858534427490457326786488000343953432478356694281949855178817536*dq1*dq2*q3*sin(q2) + 9946281115547779716645852274853036047668089532778274734818156495955070166237184*L2c*dq1*dq2*cos(2*q2) + 9946281115547779716645852274853036047668089532778274734818156495955070166237184*dq1*dq2*q3*cos(2*q2)))/43322963970637732180912721627235682866194329302747133987038743447103457934462900359999600095377180907771737671271930809827721216;

    tau1 = u(1) -B*dth(1);
    tau2 = u(2) -B*dth(2);
    tau3 = u(3) -B*dth(3); 
    
    % Dynamic equations of motion
    ddq1 = (23134322349737717735007099635340398196389939425877994392829742617792799769376488882250616154966884883028833178263183636958116334868264988711557463284619886869901974011493334886285674639701857680117842364845001582447907831808*I2*tau1 - 1416568690802468555388375809904375987116414004506904182663104987832746828540294323805294479538772904609827289202900921934775435213089308706025622002378529526260326363007263750076748909857384980572632143364096*I2*tau2 + 23134322349737717735007099635340398196389939425877994392829742617792799769376488882250616154966884883028833178263183636958116334868264988711557463284619886869901974011493334886285674639701857680117842364845001582447907831808*I3*tau1 - 1416568690802468555388375809904375987116414004506904182663104987832746828540294323805294479538772904609827289202900921934775435213089308706025622002378529526260326363007263750076748909857384980572632143364096*I3*tau2 + 23134322349737717735007099635340441566297763515872930048141399618038216833736069295778425670733711177253754152718979865204091869792072659135057948428280683038276367456230827977483309640328480041007426190169235866885461901312*m3*q3^2*tau1 - 1416568690802468555388375809904378642757353808885024111996651949244018748189204475286681708365756389855297855719369711158430910370423736221263077798545585142319230406795462029527370536789867479111559590969344*m3*q3^2*tau2 + 23134322349737717735007099635340441566297763515872930048141399618038216833736069295778425670733711177253754152718979865204091869792072659135057948428280683038276367456230827977483309640328480041007426190169235866885461901312*L2c^2*m3*tau1 - 1416568690802468555388375809904378642757353808885024111996651949244018748189204475286681708365756389855297855719369711158430910370423736221263077798545585142319230406795462029527370536789867479111559590969344*L2c^2*m3*tau2 + 708284345401234277694187904952184010096797295686272197331232051784529946751623388788388066628220091205213661536577556502072746884499172123624370326113575887327820099334261329967490183023498904279360160661504*dq1^2*m3^2*q3^4*sin(2*q2) - 2655640939804378119929333546961416250448997296333445446672127213862989301944279858696100266061152682374500748208123108757433296899715950555988082272237434639111271782360809472*dq3^2*m3^2*q3^2*sin(2*q2) - (10622563759217512479717334187845704830030776274789494262234910698548573839734339955427499202916797843055876714176305375342961266643391417116569311123289448281630569198533039351*dq2^2*m3^2*q3^4*sin(2*q2))/4 - 663910234951094529982333386740350328715238034446888317085556630682439451952747422243867608575791659633386053987785570912995395728174865870715546830101482042318268304405299200*dq1^2*m3^2*q3^4*sin(4*q2) + 2489264674193090982029721650115188871915688881694953438305292997673973492755376163470850908618997836081178854315825305251078306366427456602112*dq3^2*m3^2*q3^2*sin(4*q2) + (19914117393544727856237773200921585641306446166961015591696328205721769931678334505173505959127061838965461782455431897701098734550649436984567*dq2^2*m3^2*q3^4*sin(4*q2))/8 + 1416568690802468555388375809904377314936883906695964147329878468538382788364749399545988093952264647232562572461135316546603172791756522463644349900462057334289778384901362889802059723323626229842095867166720*L2c^3*g*m3^2*cos(q2) - 2655640939804378119929333546961411271919648910151481387228826983485245470566516468789223655475157334427515237455796167055616058904043788198279450621626932482498538927447605248*I2*dq3^2*m3*sin(2*q2) - 2655640939804378119929333546961411271919648910151481387228826983485245470566516468789223655475157334427515237455796167055616058904043788198279450621626932482498538927447605248*I3*dq3^2*m3*sin(2*q2) - 43369907824089994935655311657000245417064359580413527809515766826294224920974455796228245975534923807670423500485143660796168374393444737493091197635000626622360889583825324234284437554069504*L2c^2*m3*tau1*cos(2*q2) + 2655640939804378119929333546961411271919648910151481387228826983485245470566516468789223655475157334427515237455796167055616058904043788198279450621626932482498538927447605248*L2c^2*m3*tau2*cos(2*q2) + 1416568690802468555388375809904377314936883906695964147329878468538382788364749399545988093952264647232562572461135316546603172791756522463644349900462057334289778384901362889802059723323626229842095867166720*g*m3^2*q3^3*cos(q2) - 43369907824089994935655311657000245417064359580413527809515766826294224920974455796228245975534923807670423500485143660796168374393444737493091197635000626622360889583825324234284437554069504*m3*q3^2*tau1*cos(2*q2) + 2655640939804378119929333546961411271919648910151481387228826983485245470566516468789223655475157334427515237455796167055616058904043788198279450621626932482498538927447605248*m3*q3^2*tau2*cos(2*q2) + 1327820469902189059964666773480710614489172841257704753057713722120366566661021624301488438323574015160743129480225025229625267447694056456848356961423968397862002318637006848*L2c^2*dq3^2*m3^2*cos(q2) - 354142172700617138847093952476088685497223892370486186998682324125685809140480914060430275630265500173852933741007838283161736497907578175009989254377117514971282158850703961354642752595068022599593314222080*L2c^4*dq1^2*m3^2*cos(q2) + 1416568690802468555388375809904386609680173222019383899997292833497748624529479657587081168047628356567035066322335706335839679823818806709018454494813559259447925226809487702405837859595941425659761586601984*L2c^4*dq2^2*m3^2*cos(q2) - 1327820469902189059964666773480705635959824455075740693614413491742622735283258234394611827737578667213757618727898083527808029452021894099139725310813466241249269463723802624*L2c^3*g*m3^2*cos(3*q2) - 708284345401234277694187904952190649199146806631572020665099455327645333919057313384034468596369937550384211117919250191043192763879081868250266797356320379189067225291830154488996081861174988825243519287296*L2c^3*g*m3^2*sin(2*q2) - 354142172700617138847093952476088685497223892370486186998682324125685809140480914060430275630265500173852933741007838283161736497907578175009989254377117514971282158850703961354642752595068022599593314222080*dq1^2*m3^2*q3^4*cos(q2) + 1327820469902189059964666773480710614489172841257704753057713722120366566661021624301488438323574015160743129480225025229625267447694056456848356961423968397862002318637006848*dq3^2*m3^2*q3^2*cos(q2) + 1416568690802468555388375809904386609680173222019383899997292833497748624529479657587081168047628356567035066322335706335839679823818806709018454494813559259447925226809487702405837859595941425659761586601984*dq2^2*m3^2*q3^4*cos(q2) - 1327820469902189059964666773480705635959824455075740693614413491742622735283258234394611827737578667213757618727898083527808029452021894099139725310813466241249269463723802624*g*m3^2*q3^3*cos(3*q2) - 23134322349737717735007099635340419881343851470875462220485571118159424964802486631039962440870066910596246729098845240707469689508638422007107878284140360932135091578418127748764940114573879616143393458497678319054160396288*L2c^3*dq1*dq3*m3^2 - 708284345401234277694187904952190649199146806631572020665099455327645333919057313384034468596369937550384211117919250191043192763879081868250266797356320379189067225291830154488996081861174988825243519287296*g*m3^2*q3^3*sin(2*q2) - 23134322349737717735007099635340419881343851470875462220485571118159424964802486631039962440870066910596246729098845240707469689508638422007107878284140360932135091578418127748764940114573879616143393458497678319054160396288*dq1*dq3*m3^2*q3^3 - 1327820469902189059964666773480710614489172841257704753057713722120366566661021624301488438323574015160743129480225025229625267447694056456848356961423968397862002318637006848*L2c^2*dq3^2*m3^2*cos(3*q2) + 354142172700617138847093952476093996779103501126726045665776246948229648438301217023204733284232470664794066773945416730472686812576433205484900846711228747089090246427100520255886006460033019677448209432576*L2c^4*dq1^2*m3^2*cos(3*q2) + 1416568690802468555388375809904381298398293613263144041330198910655290667838114626768068937192739875100768422235838500382086385527758163736500533594712640758378134450583660308977992163722349977650487038574592*L2c^2*m3*tau2*sin(q2) - 2655640939804378119929333546961416250448997296333445446672127213862989301944279858696100266061152682374500748208123108757433296899715950555988082272237434639111271782360809472*L2c^2*dq3^2*m3^2*sin(2*q2) + 708284345401234277694187904952184010096797295686272197331232051784529946751623388788388066628220091205213661536577556502072746884499172123624370326113575887327820099334261329967490183023498904279360160661504*L2c^4*dq1^2*m3^2*sin(2*q2) - (10622563759217512479717334187845704830030776274789494262234910698548573839734339955427499202916797843055876714176305375342961266643391417116569311123289448281630569198533039351*L2c^4*dq2^2*m3^2*sin(2*q2))/4 + 2489264674193090982029721650115188871915688881694953438305292997673973492755376163470850908618997836081178854315825305251078306366427456602112*L2c^2*dq3^2*m3^2*sin(4*q2) - 663910234951094529982333386740350328715238034446888317085556630682439451952747422243867608575791659633386053987785570912995395728174865870715546830101482042318268304405299200*L2c^4*dq1^2*m3^2*sin(4*q2) + (19914117393544727856237773200921585641306446166961015591696328205721769931678334505173505959127061838965461782455431897701098734550649436984567*L2c^4*dq2^2*m3^2*sin(4*q2))/8 + 354142172700617138847093952476093996779103501126726045665776246948229648438301217023204733284232470664794066773945416730472686812576433205484900846711228747089090246427100520255886006460033019677448209432576*dq1^2*m3^2*q3^4*cos(3*q2) - 1327820469902189059964666773480710614489172841257704753057713722120366566661021624301488438323574015160743129480225025229625267447694056456848356961423968397862002318637006848*dq3^2*m3^2*q3^2*cos(3*q2) + 1416568690802468555388375809904381298398293613263144041330198910655290667838114626768068937192739875100768422235838500382086385527758163736500533594712640758378134450583660308977992163722349977650487038574592*m3*q3^2*tau2*sin(q2) + 46268644699475435470014199270680883132595527031745860096282799236076433667472138591556851341467422354507508305437959730408183739584145318270115896856561366076552734912461655954966619280656960082014852380338471733770923802624*L2c*m3*q3*tau1 - 2833137381604937110776751619808757285514707617770048223993303898488037496378408950573363416731512779710595711438739422316861820740847472442526155597091170284638460813590924059054741073579734958223119181938688*L2c*m3*q3*tau2 + 23134322349737717735007099635340354826482115335883058737518085617384771596186103440705845620520212058806607065172629287926851349360709172975243360426050430381452526350027015082401474107935940158131088028347434674064405299200*dq1*dq2*m3^2*q3^4*sin(2*q2) - 21684953912044997467827655828500041402977764387692755424248543489882113807917910519053730343042170029762555343433714376067924149669614004333189255534734743663599896206657075450830245802803200*dq1*dq2*m3^2*q3^4*sin(4*q2) - 69402967049213153205021298906021259644031554412626386661456713354478274894407459893119887322610200731788740187296535722122409068525915266021323634852421082796405274735254383246294820343721638848430180375493034957162481188864*L2c*dq1*dq3*m3^2*q3^2 - 69402967049213153205021298906021259644031554412626386661456713354478274894407459893119887322610200731788740187296535722122409068525915266021323634852421082796405274735254383246294820343721638848430180375493034957162481188864*L2c^2*dq1*dq3*m3^2*q3 - 23134322349737717735007099635340484936205587605867865703453056618608856115757259765340157223860229312085279211985127412951888187620506460336958663475528247177378655360376382824521541940366716742671355590147549610506316677120*I2*L2c*dq1*dq3*m3 - 23134322349737717735007099635340484936205587605867865703453056618608856115757259765340157223860229312085279211985127412951888187620506460336958663475528247177378655360376382824521541940366716742671355590147549610506316677120*I3*L2c*dq1*dq3*m3 - 86739815648179989871310623314000490834128719160827055619031533652588449841948911592456491951069847615340847000970287321592336748786889474986182395270001253244721779167650648468568875108139008*L2c*m3*q3*tau1*cos(2*q2) + 5311281879608756239858667093922822543839297820302962774457653966970490941133032937578447310950314668855030474911592334111232117808087576396558901243253864964997077854895210496*L2c*m3*q3*tau2*cos(2*q2) + 1416568690802468555388375809904375987116414004506904182663104987792918593753204868092818933136929882659176267095781666921890747250305732821939603386844914988356360985708402081023544025840132078709792837730304*L2c*dq1^2*m3^2*q3^3*cos(3*q2) + 1416568690802468555388375809904375987116414004506904182663104987792918593753204868092818933136929882659176267095781666921890747250305732821939603386844914988356360985708402081023544025840132078709792837730304*L2c^3*dq1^2*m3^2*q3*cos(3*q2) - 2124853036203702833082563714856532112983343354222917121992093944754114854842885484362581653781593001043117602446047029698970418987445469050059935526262705089827692953104223768127856515570408135597559885332480*L2c^2*dq1^2*m3^2*q3^2*cos(q2) + 8499412144814811332330254859426319658081039332116303399983757000986491747176877945522487008285770139402210397934014238015038078942912840254110726968881355556687551360856926214435027157575648553958569519611904*L2c^2*dq2^2*m3^2*q3^2*cos(q2) - 23134322349737717735007099635340484936205587605867865703453056618608856115757259765340157223860229312085279211985127412951888187620506460336958663475528247177378655360376382824521541940366716742671355590147549610506316677120*I2*dq1*dq3*m3*q3 - 23134322349737717735007099635340484936205587605867865703453056618608856115757259765340157223860229312085279211985127412951888187620506460336958663475528247177378655360376382824521541940366716742671355590147549610506316677120*I3*dq1*dq3*m3*q3 + 2833137381604937110776751619808736040387189182745088789324928207138119787006493555153552266512880364820854646146310226008290987537996688494497481304454303549311280397337045319869960732093995617117440642646016*L2c*dq1^2*m3^2*q3^3*sin(2*q2) + 2833137381604937110776751619808736040387189182745088789324928207138119787006493555153552266512880364820854646146310226008290987537996688494497481304454303549311280397337045319869960732093995617117440642646016*L2c^3*dq1^2*m3^2*q3*sin(2*q2) - 10622563759217512479717334187845704830030776274789494262234910698548573839734339955427499202916797843055876714176305375342961266643391417116569311123289448281630569198533039351*L2c*dq2^2*m3^2*q3^3*sin(2*q2) - 10622563759217512479717334187845704830030776274789494262234910698548573839734339955427499202916797843055876714176305375342961266643391417116569311123289448281630569198533039351*L2c^3*dq2^2*m3^2*q3*sin(2*q2) - 2655640939804378119929333546961401314860952137787553268342226522729757807810989688975470434303166638533544215951142283651981582912699463482862187320405928169273073217621196800*L2c*dq1^2*m3^2*q3^3*sin(4*q2) - 2655640939804378119929333546961401314860952137787553268342226522729757807810989688975470434303166638533544215951142283651981582912699463482862187320405928169273073217621196800*L2c^3*dq1^2*m3^2*q3*sin(4*q2) + (19914117393544727856237773200921585641306446166961015591696328205721769931678334505173505959127061838965461782455431897701098734550649436984567*L2c*dq2^2*m3^2*q3^3*sin(4*q2))/2 + (19914117393544727856237773200921585641306446166961015591696328205721769931678334505173505959127061838965461782455431897701098734550649436984567*L2c^3*dq2^2*m3^2*q3*sin(4*q2))/2 + 5311281879608756239858667093922822543839297820302962774457653966970490941133032937578447310950314668855030474911592334111232117808087576396558901243253864964997077854895210496*I2*L2c^2*dq1^2*m3*cos(q2) + 1416568690802468555388375809904386609680173222019383899997292833497748624529479657587081168047628356567035066322335706335839679823818806709018454494813559259447925226809487702405837859595941425659761586601984*I2*L2c^2*dq2^2*m3*cos(q2) + 5311281879608756239858667093922822543839297820302962774457653966970490941133032937578447310950314668855030474911592334111232117808087576396558901243253864964997077854895210496*I3*L2c^2*dq1^2*m3*cos(q2) + 1416568690802468555388375809904386609680173222019383899997292833497748624529479657587081168047628356567035066322335706335839679823818806709018454494813559259447925226809487702405837859595941425659761586601984*I3*L2c^2*dq2^2*m3*cos(q2) + 173479631296359979742621246628001144279366269126682128199081747151706896989036457943033769191590278978827006815558289551844993572627995678799077477105533645784604655505812470269761696164741120*L2c^4*dq1*dq2*m3^2*cos(q2) + 5311281879608756239858667093922822543839297820302962774457653966970490941133032937578447310950314668855030474911592334111232117808087576396558901243253864964997077854895210496*I2*dq1^2*m3*q3^2*cos(q2) + 1416568690802468555388375809904386609680173222019383899997292833497748624529479657587081168047628356567035066322335706335839679823818806709018454494813559259447925226809487702405837859595941425659761586601984*I2*dq2^2*m3*q3^2*cos(q2) + 5311281879608756239858667093922822543839297820302962774457653966970490941133032937578447310950314668855030474911592334111232117808087576396558901243253864964997077854895210496*I3*dq1^2*m3*q3^2*cos(q2) + 1416568690802468555388375809904386609680173222019383899997292833497748624529479657587081168047628356567035066322335706335839679823818806709018454494813559259447925226809487702405837859595941425659761586601984*I3*dq2^2*m3*q3^2*cos(q2) + 2655640939804378119929333546961421228978345682515409506115427444240733133322043248602976876647148030321486258960450050459250534895388112913696713922847936795724004637274013696*L2c*dq3^2*m3^2*q3*cos(q2) + 4249706072407405666165127429713131944810651720087892441989635405615148365094248198637964281856793941697687717383405949639809518375269567390933049701386172002869335154704088669406179169970878689526287601500160*L2c*g*m3^2*q3^2*cos(q2) + 4249706072407405666165127429713131944810651720087892441989635405615148365094248198637964281856793941697687717383405949639809518375269567390933049701386172002869335154704088669406179169970878689526287601500160*L2c^2*g*m3^2*q3*cos(q2) + 173479631296359979742621246628001144279366269126682128199081747151706896989036457943033769191590278978827006815558289551844993572627995678799077477105533645784604655505812470269761696164741120*dq1*dq2*m3^2*q3^4*cos(q2) + 1416568690802468555388375809904375987116414004506904182663104987832746828540294323805294479538772904609827289202900921934775435213089308706025622002378529526260326363007263750076748909857384980572632143364096*I2*L2c*g*m3*cos(q2) + 1416568690802468555388375809904375987116414004506904182663104987832746828540294323805294479538772904609827289202900921934775435213089308706025622002378529526260326363007263750076748909857384980572632143364096*I3*L2c*g*m3*cos(q2) + 2124853036203702833082563714856563980674621006760356273994657481689377890629807302139228399705394823988764400643672500382836120875458599232909405080267372482534541478562603121535316038760198118064689256595456*L2c^2*dq1^2*m3^2*q3^2*cos(3*q2) + 4249706072407405666165127429713104060580783774117633183987392310707179680509740332730328399769320547231281969219465339012436481306995032741746221956681455323966920596005567979804941098140993425676160963969024*L2c^2*dq1^2*m3^2*q3^2*sin(2*q2) - (31867691277652537439152002563537114490092328824368482786704732095645721519203019866282497608750393529167630142528916126028883799930174251349707933369868344844891707595599118053*L2c^2*dq2^2*m3^2*q3^2*sin(2*q2))/2 - 3983461409706567179894000320442101972291428206681329902513339784094636711716484533463205651454749957800316323926713425477972374369049195224293280980608892253909609826431795200*L2c^2*dq1^2*m3^2*q3^2*sin(4*q2) + (59742352180634183568713319602764756923919338500883046775088984617165309795035003515520517877381185516896385347366295693103296203651948310953701*L2c^2*dq2^2*m3^2*q3^2*sin(4*q2))/4 + 1416568690802468555388375809904375987116414004506904182663104987832746828540294323805294479538772904609827289202900921934775435213089308706025622002378529526260326363007263750076748909857384980572632143364096*I2*g*m3*q3*cos(q2) + 1416568690802468555388375809904375987116414004506904182663104987832746828540294323805294479538772904609827289202900921934775435213089308706025622002378529526260326363007263750076748909857384980572632143364096*I3*g*m3*q3*cos(q2) + 708284345401234277694187904952185337917267197875332161998005532505101494621237010421260010942402967059443078084981671743732242449210226837775355205022209147071259137715433595587752827996209991747388624076800*I2*L2c^2*dq1^2*m3*sin(2*q2) - 2655640939804378119929333546961421228978345682515409506115427444240733133322043248602976876647148030321486258960450050459250534895388112913696713922847936795724004637274013696*I2*L2c^2*dq2^2*m3*sin(2*q2) + 708284345401234277694187904952185337917267197875332161998005532505101494621237010421260010942402967059443078084981671743732242449210226837775355205022209147071259137715433595587752827996209991747388624076800*I3*L2c^2*dq1^2*m3*sin(2*q2) - 2655640939804378119929333546961421228978345682515409506115427444240733133322043248602976876647148030321486258960450050459250534895388112913696713922847936795724004637274013696*I3*L2c^2*dq2^2*m3*sin(2*q2) - 23134322349737717735007099635340398196389939425877994392829742618118021987038098938284538192326576723635437263073534956459937117772891119489957693188206654840629868470901396642126271939113472020892187939499081041631208538112*L2c^3*dq1*dq3*m3^2*cos(2*q2) - 162611108830805028016961018679846529997305138634758120785289450583748145312813617714908660320075054216728826712686565531139295161097170511173332623945948463104*L2c^4*dq1*dq2*m3^2*cos(3*q2) + 21684953912044997467827655828500041402977764387692755424248543490186960809466025310284247532571735747302517150185095933706091505223107516731106638668175460407595251205518998597277422951858176*L2c^3*dq1*dq3*m3^2*cos(4*q2) - 2655640939804378119929333546961421228978345682515409506115427444240733133322043248602976876647148030321486258960450050459250534895388112913696713922847936795724004637274013696*L2c*dq3^2*m3^2*q3*cos(3*q2) - 1416568690802468555388375809904354741988895569481944747994729296502743236561923656241721102521062000695411734964031353132646945991630312700039957017508470059885128635402815845418571010380272090398373256888320*L2c*dq1^2*m3^2*q3^3*cos(q2) - 1416568690802468555388375809904354741988895569481944747994729296502743236561923656241721102521062000695411734964031353132646945991630312700039957017508470059885128635402815845418571010380272090398373256888320*L2c^3*dq1^2*m3^2*q3*cos(q2) + 5666274763209874221553503239617546438720692888077535599989171333990994498117918630348324672190513426268140265289342825343358719295275226836073817979254237037791700907237950809623351438383765702639046346407936*L2c*dq2^2*m3^2*q3^3*cos(q2) + 5666274763209874221553503239617546438720692888077535599989171333990994498117918630348324672190513426268140265289342825343358719295275226836073817979254237037791700907237950809623351438383765702639046346407936*L2c^3*dq2^2*m3^2*q3*cos(q2) + 2833137381604937110776751619808762596796587226526288082660397821310581335676229253536137874385479750201536844471677000764172771055516327473001067189425281516756268901167320617955984327444699955300974077149184*L2c*m3*q3*tau2*sin(q2) - 3983461409706567179894000320442116907879473365227222080843240475227868205849774703183835483212736001641272856183694250583424088356065682297419175932440398723747808391171407872*L2c*g*m3^2*q3^2*cos(3*q2) - 3983461409706567179894000320442116907879473365227222080843240475227868205849774703183835483212736001641272856183694250583424088356065682297419175932440398723747808391171407872*L2c^2*g*m3^2*q3*cos(3*q2) + 23134322349737717735007099635340354826482115335883058737518085617384771596186103440705845620520212058806607065172629287926851349360709172975243360426050430381452526350027015082401474107935940158131088028347434674064405299200*L2c^4*dq1*dq2*m3^2*sin(2*q2) - 21684953912044997467827655828500041402977764387692755424248543489882113807917910519053730343042170029762555343433714376067924149669614004333189255534734743663599896206657075450830245802803200*L2c^4*dq1*dq2*m3^2*sin(4*q2) + 708284345401234277694187904952185337917267197875332161998005532505101494621237010421260010942402967059443078084981671743732242449210226837775355205022209147071259137715433595587752827996209991747388624076800*I2*dq1^2*m3*q3^2*sin(2*q2) - 2655640939804378119929333546961421228978345682515409506115427444240733133322043248602976876647148030321486258960450050459250534895388112913696713922847936795724004637274013696*I2*dq2^2*m3*q3^2*sin(2*q2) + 708284345401234277694187904952185337917267197875332161998005532505101494621237010421260010942402967059443078084981671743732242449210226837775355205022209147071259137715433595587752827996209991747388624076800*I3*dq1^2*m3*q3^2*sin(2*q2) - 2655640939804378119929333546961421228978345682515409506115427444240733133322043248602976876647148030321486258960450050459250534895388112913696713922847936795724004637274013696*I3*dq2^2*m3*q3^2*sin(2*q2) - 5311281879608756239858667093922832500897994592666890893344254427725978603888559717392200532122305364749001496416246217514866593799431901111976164544474869278222543564721618944*L2c*dq3^2*m3^2*q3*sin(2*q2) + 4978529348386181964059443300230377743831377763389906876610585995347946985510752326941701817237995672162357708631650610502156612732854913204224*L2c*dq3^2*m3^2*q3*sin(4*q2) - 2124853036203702833082563714856571947597440419894716061995298365982936001757171940152103405789109812651152633353757750573129578291637245604750800392068961137567201675875490463466988245583524966475730557861888*L2c*g*m3^2*q3^2*sin(2*q2) - 2124853036203702833082563714856571947597440419894716061995298365982936001757171940152103405789109812651152633353757750573129578291637245604750800392068961137567201675875490463466988245583524966475730557861888*L2c^2*g*m3^2*q3*sin(2*q2) - 23134322349737717735007099635340398196389939425877994392829742618118021987038098938284538192326576723635437263073534956459937117772891119489957693188206654840629868470901396642126271939113472020892187939499081041631208538112*dq1*dq3*m3^2*q3^3*cos(2*q2) - 162611108830805028016961018679846529997305138634758120785289450583748145312813617714908660320075054216728826712686565531139295161097170511173332623945948463104*dq1*dq2*m3^2*q3^4*cos(3*q2) + 21684953912044997467827655828500041402977764387692755424248543490186960809466025310284247532571735747302517150185095933706091505223107516731106638668175460407595251205518998597277422951858176*dq1*dq3*m3^2*q3^3*cos(4*q2) + 173479631296359979742621246628000981668257438321654111238063067305176899683897823184912983902139695230681694001940574643184673497573778949972364790540002506489443558335301296937137750216278016*I2*L2c*dq1*dq3*m3*sin(q2) + 2833137381604937110776751619808773219360346444038767799994585666995497249058959315174162336095256713134070132644671412671679359647637613418036908989627118518895850453618975404811675719191882851319523173203968*I2*L2c*dq2*dq3*m3*sin(q2) + 173479631296359979742621246628000981668257438321654111238063067305176899683897823184912983902139695230681694001940574643184673497573778949972364790540002506489443558335301296937137750216278016*I3*L2c*dq1*dq3*m3*sin(q2) + 2833137381604937110776751619808773219360346444038767799994585666995497249058959315174162336095256713134070132644671412671679359647637613418036908989627118518895850453618975404811675719191882851319523173203968*I3*L2c*dq2*dq3*m3*sin(q2) + 173479631296359979742621246628000981668257438321654111238063067305176899683897823184912983902139695230681694001940574643184673497573778949972364790540002506489443558335301296937137750216278016*I2*dq1*dq3*m3*q3*sin(q2) + 2833137381604937110776751619808773219360346444038767799994585666995497249058959315174162336095256713134070132644671412671679359647637613418036908989627118518895850453618975404811675719191882851319523173203968*I2*dq2*dq3*m3*q3*sin(q2) + 173479631296359979742621246628000981668257438321654111238063067305176899683897823184912983902139695230681694001940574643184673497573778949972364790540002506489443558335301296937137750216278016*I3*dq1*dq3*m3*q3*sin(q2) + 2833137381604937110776751619808773219360346444038767799994585666995497249058959315174162336095256713134070132644671412671679359647637613418036908989627118518895850453618975404811675719191882851319523173203968*I3*dq2*dq3*m3*q3*sin(q2) - 69402967049213153205021298906021194589169818277633983178489227854354065961114296814853614576979730170906311789220604869379811353318673358469873079564619964521889605412704189926378815817340416062676563818497243124893625614336*L2c*dq1*dq3*m3^2*q3^2*cos(2*q2) - 69402967049213153205021298906021194589169818277633983178489227854354065961114296814853614576979730170906311789220604869379811353318673358469873079564619964521889605412704189926378815817340416062676563818497243124893625614336*L2c^2*dq1*dq3*m3^2*q3*cos(2*q2) - 650444435323220112067844074719386119989220554539032483141157802334992581251254470859634641280300216866915306850746262124557180644388682044693330495783793852416*L2c*dq1*dq2*m3^2*q3^3*cos(3*q2) - 650444435323220112067844074719386119989220554539032483141157802334992581251254470859634641280300216866915306850746262124557180644388682044693330495783793852416*L2c^3*dq1*dq2*m3^2*q3*cos(3*q2) + 65054861736134992403482967485500124208933293163078266272745630470560882428398075930852742597715207241907551450555287801118274515669322550193319916004526381222785753616556995791832268855574528*L2c*dq1*dq3*m3^2*q3^2*cos(4*q2) + 65054861736134992403482967485500124208933293163078266272745630470560882428398075930852742597715207241907551450555287801118274515669322550193319916004526381222785753616556995791832268855574528*L2c^2*dq1*dq3*m3^2*q3*cos(4*q2) + 1040877787778159878455727479768006865676197614760092769194490482910241381934218747658202615149541673872962040893349737311069961435767974072794464862633201874707627933034874821618570176988446720*L2c^2*dq1*dq2*m3^2*q3^2*cos(q2) + 92537289398950870940028398541361419305928461343532234950072342469539086384744413762823382482080848235226428260690517151707405397442836691900973441704201721525810105400108060329605896431743760632524352113389738696257621196800*L2c*dq1*dq2*m3^2*q3^3*sin(2*q2) + 92537289398950870940028398541361419305928461343532234950072342469539086384744413762823382482080848235226428260690517151707405397442836691900973441704201721525810105400108060329605896431743760632524352113389738696257621196800*L2c^3*dq1*dq2*m3^2*q3*sin(2*q2) - 86739815648179989871310623314000165611911057550771021696994173959528455231671642076214921372168680119050221373734857504271696598678456017332757022138938974654399584826628301803320983211212800*L2c*dq1*dq2*m3^2*q3^3*sin(4*q2) - 86739815648179989871310623314000165611911057550771021696994173959528455231671642076214921372168680119050221373734857504271696598678456017332757022138938974654399584826628301803320983211212800*L2c^3*dq1*dq2*m3^2*q3*sin(4*q2) - 23134322349737717735007099635340311456574291245888123082206428617627187858318938111228919160792924135185595314161942499967986047925275778642956722900885062503881081581426410459731001937860227299113020288850612472756100399104*I2*L2c*dq1*dq3*m3*cos(2*q2) - 23134322349737717735007099635340311456574291245888123082206428617627187858318938111228919160792924135185595314161942499967986047925275778642956722900885062503881081581426410459731001937860227299113020288850612472756100399104*I3*L2c*dq1*dq3*m3*cos(2*q2) + 173479631296359979742621246628000981668257438321654111238063067305176899683897823184912983902139695230681694001940574643184673497573778949972364790540002506489443558335301296937137750216278016*I2*L2c^2*dq1*dq2*m3*cos(q2) + 173479631296359979742621246628000981668257438321654111238063067305176899683897823184912983902139695230681694001940574643184673497573778949972364790540002506489443558335301296937137750216278016*I3*L2c^2*dq1*dq2*m3*cos(q2) + 10622563759217512479717334187845645087678595640605925548915307933940981882266065875156894621900629337710060949823184668222464235616175152793117802486507729929994155709790420992*I2*L2c*dq1^2*m3*q3*cos(q2) + 2833137381604937110776751619808773219360346444038767799994585666995497249058959315174162336095256713134070132644671412671679359647637613418036908989627118518895850453618975404811675719191882851319523173203968*I2*L2c*dq2^2*m3*q3*cos(q2) + 10622563759217512479717334187845645087678595640605925548915307933940981882266065875156894621900629337710060949823184668222464235616175152793117802486507729929994155709790420992*I3*L2c*dq1^2*m3*q3*cos(q2) + 2833137381604937110776751619808773219360346444038767799994585666995497249058959315174162336095256713134070132644671412671679359647637613418036908989627118518895850453618975404811675719191882851319523173203968*I3*L2c*dq2^2*m3*q3*cos(q2) - 23134322349737717735007099635340311456574291245888123082206428617627187858318938111228919160792924135185595314161942499967986047925275778642956722900885062503881081581426410459731001937860227299113020288850612472756100399104*I2*dq1*dq3*m3*q3*cos(2*q2) - 23134322349737717735007099635340311456574291245888123082206428617627187858318938111228919160792924135185595314161942499967986047925275778642956722900885062503881081581426410459731001937860227299113020288850612472756100399104*I3*dq1*dq3*m3*q3*cos(2*q2) + 173479631296359979742621246628000981668257438321654111238063067305176899683897823184912983902139695230681694001940574643184673497573778949972364790540002506489443558335301296937137750216278016*I2*dq1*dq2*m3*q3^2*cos(q2) + 173479631296359979742621246628000981668257438321654111238063067305176899683897823184912983902139695230681694001940574643184673497573778949972364790540002506489443558335301296937137750216278016*I3*dq1*dq2*m3*q3^2*cos(q2) - 975666652984830168101766112079079179983830831808548724711736703502488871876881706289451961920450325300372960276119393186835770966583023067039995743675690778624*L2c^2*dq1*dq2*m3^2*q3^2*cos(3*q2) + 138805934098426306410042597812042128958892692015298352425108513704308629577116620644235073723121272352839642391035775727561108096164255037851460162556302582288715158100162090494408844647615640948786528170084608044386431795200*L2c^2*dq1*dq2*m3^2*q3^2*sin(2*q2) - 130109723472269984806965934971000248417866586326156532545491260939292682847507463114322382058253020178575332060602286256407544898017684025999135533208408461981599377239942452704981474816819200*L2c^2*dq1*dq2*m3^2*q3^2*sin(4*q2) + 23134322349737717735007099635340311456574291245888123082206428617301965640657328055194997123433232294578991229351591180466165265020649647864556492997298294533153187122018348703890404638448612958338674714196533013572799692800*I2*L2c^2*dq1*dq2*m3*sin(2*q2) + 23134322349737717735007099635340311456574291245888123082206428617301965640657328055194997123433232294578991229351591180466165265020649647864556492997298294533153187122018348703890404638448612958338674714196533013572799692800*I3*L2c^2*dq1*dq2*m3*sin(2*q2) + 1416568690802468555388375809904370675834534395750664323996011065010202989242474020842520021884805934118886156169963343487464484898420453675550710410044418294142518275430867191175505655992419983494777248153600*I2*L2c*dq1^2*m3*q3*sin(2*q2) - 5311281879608756239858667093922842457956691365030819012230854888481466266644086497205953753294296060642972517920900100918501069790776225827393427845695873591448009274548027392*I2*L2c*dq2^2*m3*q3*sin(2*q2) + 1416568690802468555388375809904370675834534395750664323996011065010202989242474020842520021884805934118886156169963343487464484898420453675550710410044418294142518275430867191175505655992419983494777248153600*I3*L2c*dq1^2*m3*q3*sin(2*q2) - 5311281879608756239858667093922842457956691365030819012230854888481466266644086497205953753294296060642972517920900100918501069790776225827393427845695873591448009274548027392*I3*L2c*dq2^2*m3*q3*sin(2*q2) + 693918525185439918970484986512004577117465076506728512796326988606827587956145831772135076766361115915308027262233158207379974290511982715196309908422134583138418622023249881079046784658964480*L2c*dq1*dq2*m3^2*q3^3*cos(q2) + 693918525185439918970484986512004577117465076506728512796326988606827587956145831772135076766361115915308027262233158207379974290511982715196309908422134583138418622023249881079046784658964480*L2c^3*dq1*dq2*m3^2*q3*cos(q2) + 23134322349737717735007099635340311456574291245888123082206428617301965640657328055194997123433232294578991229351591180466165265020649647864556492997298294533153187122018348703890404638448612958338674714196533013572799692800*I2*dq1*dq2*m3*q3^2*sin(2*q2) + 23134322349737717735007099635340311456574291245888123082206428617301965640657328055194997123433232294578991229351591180466165265020649647864556492997298294533153187122018348703890404638448612958338674714196533013572799692800*I3*dq1*dq2*m3*q3^2*sin(2*q2) + 346959262592719959485242493256001963336514876643308222476126134610353799367795646369825967804279390461363388003881149286369346995147557899944729581080005012978887116670602593874275500432556032*I2*L2c*dq1*dq2*m3*q3*cos(q2) + 346959262592719959485242493256001963336514876643308222476126134610353799367795646369825967804279390461363388003881149286369346995147557899944729581080005012978887116670602593874275500432556032*I3*L2c*dq1*dq2*m3*q3*cos(q2) + 46268644699475435470014199270680622913148582491776246164412857234603931281314656110389994246866464589157982458703182360932330530041299295729112985994596589066306374244036697407780809276897225916677349428393066027145599385600*I2*L2c*dq1*dq2*m3*q3*sin(2*q2) + 46268644699475435470014199270680622913148582491776246164412857234603931281314656110389994246866464589157982458703182360932330530041299295729112985994596589066306374244036697407780809276897225916677349428393066027145599385600*I3*L2c*dq1*dq2*m3*q3*sin(2*q2))/(533996758980227520598755426542388028650676130589163192486760401955554931445160137505740521734144*(43322963970637732180912721627235682866194329302747133987038743447103457934462900359999600095377180907771737671271930809827721216*I2^2 + 43322963970637732180912721627235682866194329302747133987038743447103457934462900359999600095377180907771737671271930809827721216*I3^2 + 43322963970637732180912721627235845301291901480585936367601611020049285245029261543204606702218980991476347154605394375403896832*I1*I2 + 43322963970637732180912721627235845301291901480585936367601611020049285245029261543204606702218980991476347154605394375403896832*I1*I3 + 86645927941275464361825443254471365732388658605494267974077486894206915868925800719999200190754361815543475342543861619655442432*I2*I3 + 43322963970637732180912721627236007736389473658424738748164478593604146622174390425578377248699105807418195778897268890088053089*L2c^4*m3^2*cos(q2)^2 - 162435097572177838802380562867572945827310566361183205006606841800083704609483333463565576175616*L2c^4*m3^2*cos(q2)^4 + 43322963970637732180912721627236007736389473658424738748164478593604146622174390425578377248699105807418195778897268890088053089*m3^2*q3^4*cos(q2)^2 - 162435097572177838802380562867572945827310566361183205006606841800083704609483333463565576175616*m3^2*q3^4*cos(q2)^4 + 43322963970637732180912721627236007736389473658424738748164478593604146622174390425578377248699105807418195778897268890088053089*I1*L2c^2*m3 + 43322963970637732180912721627236007736389473658424738748164478593604146622174390425578377248699105807418195778897268890088053089*I2*L2c^2*m3 + 43322963970637732180912721627236007736389473658424738748164478593604146622174390425578377248699105807418195778897268890088053089*I3*L2c^2*m3 + 43322963970637732180912721627236007736389473658424738748164478593604146622174390425578377248699105807418195778897268890088053089*I1*m3*q3^2 + 43322963970637732180912721627236007736389473658424738748164478593604146622174390425578377248699105807418195778897268890088053089*I2*m3*q3^2 + 43322963970637732180912721627236007736389473658424738748164478593604146622174390425578377248699105807418195778897268890088053089*I3*m3*q3^2 - 162435097572177838802380562867573554861377145128882373770546480124815941848624291874514684156257*I1*m3*q3^2*cos(q2)^2 + 43322963970637732180912721627235520431096757124908331606475875874157630623896539176794593488535380824067128187938467244251545600*I2*m3*q3^2*cos(q2)^2 + 43322963970637732180912721627235520431096757124908331606475875874157630623896539176794593488535380824067128187938467244251545600*I3*m3*q3^2*cos(q2)^2 + 173291855882550928723650886508944030945557894633698954992657914374416586488697561702313508994796423229672783115589075560352212356*L2c*m3^2*q3^3*cos(q2)^2 + 173291855882550928723650886508944030945557894633698954992657914374416586488697561702313508994796423229672783115589075560352212356*L2c^3*m3^2*q3*cos(q2)^2 - 649740390288711355209522251470291783309242265444732820026427367200334818437933333854262304702464*L2c*m3^2*q3^3*cos(q2)^4 - 649740390288711355209522251470291783309242265444732820026427367200334818437933333854262304702464*L2c^3*m3^2*q3*cos(q2)^4 + 86645927941275464361825443254472015472778947316849477496328957187208293244348780851156754497398211614836391557794537780176106178*I1*L2c*m3*q3 + 86645927941275464361825443254472015472778947316849477496328957187208293244348780851156754497398211614836391557794537780176106178*I2*L2c*m3*q3 + 86645927941275464361825443254472015472778947316849477496328957187208293244348780851156754497398211614836391557794537780176106178*I3*L2c*m3*q3 + 259937783823826393085476329763416046418336841950548432488986871561624879733046342553470263492194634844509174673383613340528318534*L2c^2*m3^2*q3^2*cos(q2)^2 - 974610585433067032814283377205437674963863398167099230039641050800502227656900000781393457053696*L2c^2*m3^2*q3^2*cos(q2)^4 - 162435097572177838802380562867573554861377145128882373770546480124815941848624291874514684156257*I1*L2c^2*m3*cos(q2)^2 + 43322963970637732180912721627235520431096757124908331606475875874157630623896539176794593488535380824067128187938467244251545600*I2*L2c^2*m3*cos(q2)^2 + 43322963970637732180912721627235520431096757124908331606475875874157630623896539176794593488535380824067128187938467244251545600*I3*L2c^2*m3*cos(q2)^2 - 324870195144355677604761125735147109722754290257764747541092960249631883697248583749029368312514*I1*L2c*m3*q3*cos(q2)^2 + 86645927941275464361825443254471040862193514249816663212951751748315261247793078353589186977070761648134256375876934488503091200*I2*L2c*m3*q3*cos(q2)^2 + 86645927941275464361825443254471040862193514249816663212951751748315261247793078353589186977070761648134256375876934488503091200*I3*L2c*m3*q3*cos(q2)^2));
    ddq2 = -(17460557183346545698151547444562759598985076894459837112003502023655811206616289226002385288031446155762355265177145461106061303167968095349897988777397308192692495971531096064*I2*tau1 - 285152538601387201165073225356268207805826781703034995661199532368704697950542336656619550707335712486165144348349650456918044045085964874890791332482638386765749667147516559380179637015412736*I1*tau2 - 285152538601387201165073225356268207805826781703034995661199532368704697950542336656619550707335712486165144348349650456918044045085964874890791332482638386765749667147516559380179637015412736*I2*tau2 + 17460557183346545698151547444562759598985076894459837112003502023655811206616289226002385288031446155762355265177145461106061303167968095349897988777397308192692495971531096064*I3*tau1 - 285152538601387201165073225356268207805826781703034995661199532368704697950542336656619550707335712486165144348349650456918044045085964874890791332482638386765749667147516559380179637015412736*I3*tau2 + 17460557183346545698151547444562792332286884957901169629468926130125318608524977283152616032300066206693468915770598854976581392149701210990804433014551344711137954480464592896*m3*q3^2*tau1 - 142576269300693600582536612678135707629073334451947269495354914345272119085358848385268188621506291699073264426210744189145203815962202829590561231212873399592253694739372497595836941385859072*m3*q3^2*tau2 + 17460557183346545698151547444562792332286884957901169629468926130125318608524977283152616032300066206693468915770598854976581392149701210990804433014551344711137954480464592896*L2c^2*m3*tau1 - 142576269300693600582536612678135707629073334451947269495354914345272119085358848385268188621506291699073264426210744189145203815962202829590561231212873399592253694739372497595836941385859072*L2c^2*m3*tau2 + 71288134650346800291268306339067586526843343292568672803551599138800919532830207356378265118978634209151709631120409165133218430710054196586723762920114754007691788530513404777474389457240064*dq1^2*m3^2*q3^4*sin(2*q2) - 267287693323933404961944125858029826466681372300554296156631507022651211699416282690680301276899156088845150825847815238377357841583423037334856928141756071936*dq3^2*m3^2*q3^2*sin(2*q2) - (1069150773295733619847776503432123314540053966118499144299086295594624137620528146875001138007022809750040785929951107254681452764490167036416589347949915005841*dq2^2*m3^2*q3^4*sin(2*q2))/4 + 35644067325173400145634153169533258688035023779474412513524083519769209724862793274496000697143994275085513897250503844809321862330245340636037698007289543364646415959520805583670759915520000*dq1^2*m3^2*q3^4*sin(4*q2) - 133643846661966702480972062929012908896676447692136168242035619766831019238125290209215581585160520565236046547421472077404463624054003450912846706101138227200*dq3^2*m3^2*q3^2*sin(4*q2) + (1069150773295733619847776503432107279846740058453371305608845225638667444727865337786004585580710349916548555005931622920407730390588502494379935284191996535697*dq2^2*m3^2*q3^4*sin(4*q2))/8 + 213864403951040400873804919017202492292836705944301056466528939410628331887979819206596674087033813911282768471292170309927017861663823982955731470171607295248794634665315934456590663493353472*L2c^3*g*m3^2*cos(q2) - 534575386647866809923888251716053639923370029226685652804422612811818663564084011972986895393931139740130715055188323851402069792953721871405968582374292717568*I1*dq3^2*m3*sin(2*q2) - 534575386647866809923888251716053639923370029226685652804422612811818663564084011972986895393931139740130715055188323851402069792953721871405968582374292717568*I2*dq3^2*m3*sin(2*q2) - 534575386647866809923888251716053639923370029226685652804422612811818663564084011972986895393931139740130715055188323851402069792953721871405968582374292717568*I3*dq3^2*m3*sin(2*q2) - 32733301808063441332517465424106469507401908688057150230744268620050931113650593453393870520088981733115640906444237154036518445458508933496832*L2c^2*m3*tau1*cos(2*q2) - 142576269300693600582536612678133569327526742984707573942348050130712425605241941642656970931055044424419008090162852241563628091403242306730340477917467791313081879851886873721507444214988800*L2c^2*m3*tau2*cos(2*q2) + 213864403951040400873804919017202492292836705944301056466528939410628331887979819206596674087033813911282768471292170309927017861663823982955731470171607295248794634665315934456590663493353472*g*m3^2*q3^3*cos(q2) - 32733301808063441332517465424106469507401908688057150230744268620050931113650593453393870520088981733115640906444237154036518445458508933496832*m3*q3^2*tau1*cos(2*q2) - 142576269300693600582536612678133569327526742984707573942348050130712425605241941642656970931055044424419008090162852241563628091403242306730340477917467791313081879851886873721507444214988800*m3*q3^2*tau2*cos(2*q2) + 2004336664238458140979836280133744494586611582851136124569053289057479186528865502435541784215296737708067754581757969739808768*L2c^2*dq3^2*m3^2*cos(q2) + 267287693323933404961944125858033835140009849216836255829191774511640384922581984962929439383477271047218208556852686321945788435058839172844020444081235689472*L2c^4*dq1^2*m3^2*cos(q2) + (4276603093182934479391106013728449162753602618394895020798182239954525292228197920985171648477187763149198133992085921446662302115687914400361564358135150928785*L2c^4*dq2^2*m3^2*cos(q2))/4 + 71288134650346800291268306339066784663763371492353786971174025065356212802620970821328485465527522212209504045081426120781814045701621153365170238958733895656540939925943436860753722107494400*L2c^3*g*m3^2*cos(3*q2) - 1069150773295733619847776503432107279846740058453371305608845225623637327128168023945973790787862279480261430110376647702804139585907443742811937164748585435136*L2c^3*g*m3^2*sin(2*q2) + 267287693323933404961944125858033835140009849216836255829191774511640384922581984962929439383477271047218208556852686321945788435058839172844020444081235689472*dq1^2*m3^2*q3^4*cos(q2) + 2004336664238458140979836280133744494586611582851136124569053289057479186528865502435541784215296737708067754581757969739808768*dq3^2*m3^2*q3^2*cos(q2) + (4276603093182934479391106013728449162753602618394895020798182239954525292228197920985171648477187763149198133992085921446662302115687914400361564358135150928785*dq2^2*m3^2*q3^4*cos(q2))/4 + 71288134650346800291268306339066784663763371492353786971174025065356212802620970821328485465527522212209504045081426120781814045701621153365170238958733895656540939925943436860753722107494400*g*m3^2*q3^3*cos(3*q2) + 285152538601387201165073225356269544244293401370059805381828822506813179704092319652711234324135231021997277724081855173294635451050273574736160308163350460370825526868330583465151512226824192*L2c^3*dq2*dq3*m3^2 - 1069150773295733619847776503432107279846740058453371305608845225623637327128168023945973790787862279480261430110376647702804139585907443742811937164748585435136*g*m3^2*q3^3*sin(2*q2) + 285152538601387201165073225356269544244293401370059805381828822506813179704092319652711234324135231021997277724081855173294635451050273574736160308163350460370825526868330583465151512226824192*dq2*dq3*m3^2*q3^3 - 2004336664238458140979836280133744494586611582851136124569053289057479186528865502435541784215296737708067754581757969739808768*L2c^2*dq3^2*m3^2*cos(3*q2) + 801863079971800214885832377574077453380058686152817009452213718600986115428751741255293489510963123391416279284528832464426781744324020705477080236606829363200*L2c^4*dq1^2*m3^2*cos(3*q2) - (4008673328476916281959672560267504019290822863016112279932899426185394660182626559846301172021398156474887077161635382890718097*L2c^4*dq2^2*m3^2*cos(3*q2))/4 - 17460557183346545698151547444562825065588693021342502146934350236594826010433665340302846776568686257624582566364052248847101481131434326631710877251705381229583412989398089728*L2c^2*m3*tau1*sin(q2) + 2138301546591467239695553006864214559693480116906742611217690451247274654256336047891947581575724558960522860220753295405608279171814887485623874329497170870272*L2c^2*m3*tau2*sin(q2) - 267287693323933404961944125858029826466681372300554296156631507022651211699416282690680301276899156088845150825847815238377357841583423037334856928141756071936*L2c^2*dq3^2*m3^2*sin(2*q2) + 71288134650346800291268306339067586526843343292568672803551599138800919532830207356378265118978634209151709631120409165133218430710054196586723762920114754007691788530513404777474389457240064*L2c^4*dq1^2*m3^2*sin(2*q2) - (1069150773295733619847776503432123314540053966118499144299086295594624137620528146875001138007022809750040785929951107254681452764490167036416589347949915005841*L2c^4*dq2^2*m3^2*sin(2*q2))/4 - 133643846661966702480972062929012908896676447692136168242035619766831019238125290209215581585160520565236046547421472077404463624054003450912846706101138227200*L2c^2*dq3^2*m3^2*sin(4*q2) + 35644067325173400145634153169533258688035023779474412513524083519769209724862793274496000697143994275085513897250503844809321862330245340636037698007289543364646415959520805583670759915520000*L2c^4*dq1^2*m3^2*sin(4*q2) + (1069150773295733619847776503432107279846740058453371305608845225638667444727865337786004585580710349916548555005931622920407730390588502494379935284191996535697*L2c^4*dq2^2*m3^2*sin(4*q2))/8 + 801863079971800214885832377574077453380058686152817009452213718600986115428751741255293489510963123391416279284528832464426781744324020705477080236606829363200*dq1^2*m3^2*q3^4*cos(3*q2) - 2004336664238458140979836280133744494586611582851136124569053289057479186528865502435541784215296737708067754581757969739808768*dq3^2*m3^2*q3^2*cos(3*q2) - (4008673328476916281959672560267504019290822863016112279932899426185394660182626559846301172021398156474887077161635382890718097*dq2^2*m3^2*q3^4*cos(3*q2))/4 - 17460557183346545698151547444562825065588693021342502146934350236594826010433665340302846776568686257624582566364052248847101481131434326631710877251705381229583412989398089728*m3*q3^2*tau1*sin(q2) + 2138301546591467239695553006864214559693480116906742611217690451247274654256336047891947581575724558960522860220753295405608279171814887485623874329497170870272*m3*q3^2*tau2*sin(q2) + 34921114366693091396303094889125584664573769915802339258937852260250637217049954566305232064600132413386937831541197709953162784299402421981608866029102689422275908960929185792*L2c*m3*q3*tau1 - 285152538601387201165073225356271415258146668903894538990709828690544238170717696770536377243012583398146528852421488378290407631924405659181122462425746799184507389478744995191673882771718144*L2c*m3*q3*tau2 + 17460557183346545698151547444562661399079652704135839559607229703879098328849228408935000876377420456449480439313012018765437265738190719978163643572033012562452667009620508672*dq1*dq2*m3^2*q3^4*sin(2*q2) - 16366650904031720666258732712053173388588947511254305666675659615767712301179616097820147082749410103553078950720036259987246738820348615065600*dq1*dq2*m3^2*q3^4*sin(4*q2) + 855457615804161603495219676068808632732880204110179416145486467520439539112276958958133702972405693065991833172245565519883906353150820724208480924490051381112476580604991750395454536680472576*L2c*dq2*dq3*m3^2*q3^2 + 855457615804161603495219676068808632732880204110179416145486467520439539112276958958133702972405693065991833172245565519883906353150820724208480924490051381112476580604991750395454536680472576*L2c^2*dq2*dq3*m3^2*q3 + 34921114366693091396303094889125584664573769915802339258937852260250637217049954566305232064600132413386937831541197709953162784299402421981608866029102689422275908960929185792*I1*L2c*dq1*dq3*m3 + 570305077202774402330146450712539623063973450606929534651909361063257609449736949709115600510615784873484896366473411084346558255125328907129644799779468754380850532042397063735369459266748416*I1*L2c*dq2*dq3*m3 + 17460557183346545698151547444562628665777844640694507042141805597777781598981536997401462310956965952037900662803331885623980947241035632786272211828781162118910661935797108736*I2*L2c*dq1*dq3*m3 + 570305077202774402330146450712537484762426859139689839098902496844689242641143126684544710259897048609657416864723246887626875952451410011211693041612979577671085241738775930697524022616260608*I2*L2c*dq2*dq3*m3 + 17460557183346545698151547444562628665777844640694507042141805597777781598981536997401462310956965952037900662803331885623980947241035632786272211828781162118910661935797108736*I3*L2c*dq1*dq3*m3 + 570305077202774402330146450712537484762426859139689839098902496844689242641143126684544710259897048609657416864723246887626875952451410011211693041612979577671085241738775930697524022616260608*I3*L2c*dq2*dq3*m3 - 65466603616126882665034930848212939014803817376114300461488537240101862227301186906787741040177963466231281812888474308073036890917017866993664*L2c*m3*q3*tau1*cos(2*q2) - 285152538601387201165073225356267138655053485969415147884696100261424851210483883285313941862110088848838016180325704483127256182806484613460680955834935582626163759703773747443014888429977600*L2c*m3*q3*tau2*cos(2*q2) + 3207452319887200859543329510296309813520234744611268037808854874403944461715006965021173958043852493565665117138115329857707126977296082821908320946427317452800*L2c*dq1^2*m3^2*q3^3*cos(3*q2) + 3207452319887200859543329510296309813520234744611268037808854874403944461715006965021173958043852493565665117138115329857707126977296082821908320946427317452800*L2c^3*dq1^2*m3^2*q3*cos(3*q2) - 4008673328476916281959672560267504019290822863016112279932899426185394660182626559846301172021398156474887077161635382890718097*L2c*dq2^2*m3^2*q3^3*cos(3*q2) - 4008673328476916281959672560267504019290822863016112279932899426185394660182626559846301172021398156474887077161635382890718097*L2c^3*dq2^2*m3^2*q3*cos(3*q2) + 1603726159943600429771664755148203010840059095301017534975150647069842309535491909777576636300863626283309251341116117931674730610353035037064122664487414136832*L2c^2*dq1^2*m3^2*q3^2*cos(q2) + (12829809279548803438173318041185347488260807855184685062394546719863575876684593762955514945431563289447594401976257764339986906347063743201084693074405452786355*L2c^2*dq2^2*m3^2*q3^2*cos(q2))/2 + 34921114366693091396303094889125584664573769915802339258937852260250637217049954566305232064600132413386937831541197709953162784299402421981608866029102689422275908960929185792*I1*dq1*dq3*m3*q3 + 570305077202774402330146450712539623063973450606929534651909361063257609449736949709115600510615784873484896366473411084346558255125328907129644799779468754380850532042397063735369459266748416*I1*dq2*dq3*m3*q3 + 17460557183346545698151547444562628665777844640694507042141805597777781598981536997401462310956965952037900662803331885623980947241035632786272211828781162118910661935797108736*I2*dq1*dq3*m3*q3 + 570305077202774402330146450712537484762426859139689839098902496844689242641143126684544710259897048609657416864723246887626875952451410011211693041612979577671085241738775930697524022616260608*I2*dq2*dq3*m3*q3 + 17460557183346545698151547444562628665777844640694507042141805597777781598981536997401462310956965952037900662803331885623980947241035632786272211828781162118910661935797108736*I3*dq1*dq3*m3*q3 + 570305077202774402330146450712537484762426859139689839098902496844689242641143126684544710259897048609657416864723246887626875952451410011211693041612979577671085241738775930697524022616260608*I3*dq2*dq3*m3*q3 + 285152538601387201165073225356270346107373373170274691214206396555203678131320829425513060475914536836606838524481636660532873722840216786346895051680459016030767154122053619109897557828960256*L2c*dq1^2*m3^2*q3^3*sin(2*q2) + 285152538601387201165073225356270346107373373170274691214206396555203678131320829425513060475914536836606838524481636660532873722840216786346895051680459016030767154122053619109897557828960256*L2c^3*dq1^2*m3^2*q3*sin(2*q2) - 1069150773295733619847776503432123314540053966118499144299086295594624137620528146875001138007022809750040785929951107254681452764490167036416589347949915005841*L2c*dq2^2*m3^2*q3^3*sin(2*q2) - 1069150773295733619847776503432123314540053966118499144299086295594624137620528146875001138007022809750040785929951107254681452764490167036416589347949915005841*L2c^3*dq2^2*m3^2*q3*sin(2*q2) + 142576269300693600582536612678133034752140095117897650054096334079076838899451173097984002788575977100342055589002015379237287449320981362544150792029158173458585663838083222334683039662080000*L2c*dq1^2*m3^2*q3^3*sin(4*q2) + 142576269300693600582536612678133034752140095117897650054096334079076838899451173097984002788575977100342055589002015379237287449320981362544150792029158173458585663838083222334683039662080000*L2c^3*dq1^2*m3^2*q3*sin(4*q2) + (1069150773295733619847776503432107279846740058453371305608845225638667444727865337786004585580710349916548555005931622920407730390588502494379935284191996535697*L2c*dq2^2*m3^2*q3^3*sin(4*q2))/2 + (1069150773295733619847776503432107279846740058453371305608845225638667444727865337786004585580710349916548555005931622920407730390588502494379935284191996535697*L2c^3*dq2^2*m3^2*q3*sin(4*q2))/2 + 1069150773295733619847776503432107279846740058453371305608845225623637327128168023945973790787862279480261430110376647702804139585907443742811937164748585435136*I1*L2c^2*dq1^2*m3*cos(q2) + 1069150773295733619847776503432107279846740058453371305608845225623637327128168023945973790787862279480261430110376647702804139585907443742811937164748585435136*I2*L2c^2*dq1^2*m3*cos(q2) + 1069150773295733619847776503432111288520068535369653265281405493112626500351333726218222928894440394438634487841381518786372570179382859878321100680688065052672*I2*L2c^2*dq2^2*m3*cos(q2) + 1069150773295733619847776503432107279846740058453371305608845225623637327128168023945973790787862279480261430110376647702804139585907443742811937164748585435136*I3*L2c^2*dq1^2*m3*cos(q2) + 1069150773295733619847776503432111288520068535369653265281405493112626500351333726218222928894440394438634487841381518786372570179382859878321100680688065052672*I3*L2c^2*dq2^2*m3*cos(q2) - 8730278591673272849075773722281248866285306193464588486140054585704415547646061287322474881042465843143700447492243647918241115333999566145313209110814383972628778326624829440*L2c^4*dq1*dq2*m3^2*cos(q2) + 1069150773295733619847776503432107279846740058453371305608845225623637327128168023945973790787862279480261430110376647702804139585907443742811937164748585435136*I1*dq1^2*m3*q3^2*cos(q2) + 1069150773295733619847776503432107279846740058453371305608845225623637327128168023945973790787862279480261430110376647702804139585907443742811937164748585435136*I2*dq1^2*m3*q3^2*cos(q2) + 1069150773295733619847776503432111288520068535369653265281405493112626500351333726218222928894440394438634487841381518786372570179382859878321100680688065052672*I2*dq2^2*m3*q3^2*cos(q2) + 1069150773295733619847776503432107279846740058453371305608845225623637327128168023945973790787862279480261430110376647702804139585907443742811937164748585435136*I3*dq1^2*m3*q3^2*cos(q2) + 1069150773295733619847776503432111288520068535369653265281405493112626500351333726218222928894440394438634487841381518786372570179382859878321100680688065052672*I3*dq2^2*m3*q3^2*cos(q2) + 4008673328476916281959672560267488989173223165702272249138106578114958373057731004871083568430593475416135509163515939479617536*L2c*dq3^2*m3^2*q3*cos(q2) + 641593211853121202621414757051607476878510117832903169399586818231884995663939457619790022261101441733848305413876510929781053584991471948867194410514821885746383903995947803369771990480060416*L2c*g*m3^2*q3^2*cos(q2) + 641593211853121202621414757051607476878510117832903169399586818231884995663939457619790022261101441733848305413876510929781053584991471948867194410514821885746383903995947803369771990480060416*L2c^2*g*m3^2*q3*cos(q2) - 8730278591673272849075773722281248866285306193464588486140054585704415547646061287322474881042465843143700447492243647918241115333999566145313209110814383972628778326624829440*dq1*dq2*m3^2*q3^4*cos(q2) + 285152538601387201165073225356268207805826781703034995661199532368704697950542336656619550707335712486165144348349650456918044045085964874890791332482638386765749667147516559380179637015412736*I1*L2c*g*m3*cos(q2) + 285152538601387201165073225356268207805826781703034995661199532368704697950542336656619550707335712486165144348349650456918044045085964874890791332482638386765749667147516559380179637015412736*I2*L2c*g*m3*cos(q2) + 285152538601387201165073225356268207805826781703034995661199532368704697950542336656619550707335712486165144348349650456918044045085964874890791332482638386765749667147516559380179637015412736*I3*L2c*g*m3*cos(q2) + 4811178479830801289314994265444464720280352116916902056713282311605916692572510447531760937065778740348497675707172994786560690465944124232862481419640976179200*L2c^2*dq1^2*m3^2*q3^2*cos(3*q2) - (12026019985430748845879017680802512057872468589048336839798698278556183980547879679538903516064194469424661231484906148672154291*L2c^2*dq2^2*m3^2*q3^2*cos(3*q2))/2 + 427728807902080801747609838034405519161060059755412036821309594832805517196981244138269590713871805254910257786722454990799310584260325179520342577520688524046150731183080428664846336743440384*L2c^2*dq1^2*m3^2*q3^2*sin(2*q2) - (3207452319887200859543329510296369943620161898355497432897258886783872412861584440625003414021068429250122357789853321764044358293470501109249768043849745017523*L2c^2*dq2^2*m3^2*q3^2*sin(2*q2))/2 + 213864403951040400873804919017199552128210142676846475081144501118615258349176759646976004182863965650513083383503023068855931173981472043816226188043737260187878495757124833502024559493120000*L2c^2*dq1^2*m3^2*q3^2*sin(4*q2) + (3207452319887200859543329510296321839540220175360113916826535676916002334183596013358013756742131049749645665017794868761223191171765507483139805852575989607091*L2c^2*dq2^2*m3^2*q3^2*sin(4*q2))/4 + 285152538601387201165073225356268207805826781703034995661199532368704697950542336656619550707335712486165144348349650456918044045085964874890791332482638386765749667147516559380179637015412736*I1*g*m3*q3*cos(q2) + 285152538601387201165073225356268207805826781703034995661199532368704697950542336656619550707335712486165144348349650456918044045085964874890791332482638386765749667147516559380179637015412736*I2*g*m3*q3*cos(q2) + 285152538601387201165073225356268207805826781703034995661199532368704697950542336656619550707335712486165144348349650456918044045085964874890791332482638386765749667147516559380179637015412736*I3*g*m3*q3*cos(q2) + 142576269300693600582536612678133569327526742984707573942348050130712425605241941642656970931055044424419008090162852241563628091403242306730340477917467791313081879851886873721507444214988800*I1*L2c^2*dq1^2*m3*sin(2*q2) + 534575386647866809923888251716055644260034267684826632640702746556313250175666863109111464447220197219317243920690759393186285089691429939160550340344032526336*I1*L2c^2*dq2^2*m3*sin(2*q2) + 142576269300693600582536612678133569327526742984707573942348050130712425605241941642656970931055044424419008090162852241563628091403242306730340477917467791313081879851886873721507444214988800*I2*L2c^2*dq1^2*m3*sin(2*q2) + 534575386647866809923888251716051635586705790768544672968142479067324076952501160836862326340642082260944186189685888309617854496216013803651386824404552908800*I2*L2c^2*dq2^2*m3*sin(2*q2) + 142576269300693600582536612678133569327526742984707573942348050130712425605241941642656970931055044424419008090162852241563628091403242306730340477917467791313081879851886873721507444214988800*I3*L2c^2*dq1^2*m3*sin(2*q2) + 534575386647866809923888251716051635586705790768544672968142479067324076952501160836862326340642082260944186189685888309617854496216013803651386824404552908800*I3*L2c^2*dq2^2*m3*sin(2*q2) + 285152538601387201165073225356269276956600077436654843437702964479993218019077706309884832112828825112665495682075868679846938485480403509378632714001424759335929050007394880480860325080465408*L2c^3*dq2*dq3*m3^2*cos(2*q2) + 8730278591673272849075773722281379799492538447229918556001751011582445155280813515923397858116946046868155049866057223400321471260932028708938986059430530046410612362358816768*L2c^4*dq1*dq2*m3^2*cos(3*q2) - 267287693323933404961944125858026819961685014613342826402211306405909331782042005986493447696965569870065357527594161925701034896476860935702984291187146358784*L2c^3*dq2*dq3*m3^2*cos(4*q2) - 4008673328476916281959672560267488989173223165702272249138106578114958373057731004871083568430593475416135509163515939479617536*L2c*dq3^2*m3^2*q3*cos(3*q2) + 1069150773295733619847776503432135340560039396867345023316767098046561539690327939851717757533909084188872834227410745287783153740235356691376081776324942757888*L2c*dq1^2*m3^2*q3^3*cos(q2) + 1069150773295733619847776503432135340560039396867345023316767098046561539690327939851717757533909084188872834227410745287783153740235356691376081776324942757888*L2c^3*dq1^2*m3^2*q3*cos(q2) + 4276603093182934479391106013728449162753602618394895020798182239954525292228197920985171648477187763149198133992085921446662302115687914400361564358135150928785*L2c*dq2^2*m3^2*q3^3*cos(q2) + 4276603093182934479391106013728449162753602618394895020798182239954525292228197920985171648477187763149198133992085921446662302115687914400361564358135150928785*L2c^3*dq2^2*m3^2*q3*cos(q2) - 34921114366693091396303094889125650131177386042685004293868700473189652020867330680605693553137372515249165132728104497694202962262868653263421754503410762459166825978796179456*L2c*m3*q3*tau1*sin(q2) + 4276603093182934479391106013728429119386960233813485222435380902494549308512672095783895163151449117921045720441506590811216558343629774971247748658994341740544*L2c*m3*q3*tau2*sin(q2) + 213864403951040400873804919017200353991290114477061360913522075196068638407862912463985456396582566636628512135244278362345442137104863460095510716876201686969622819777830310582261166322483200*L2c*g*m3^2*q3^2*cos(3*q2) + 213864403951040400873804919017200353991290114477061360913522075196068638407862912463985456396582566636628512135244278362345442137104863460095510716876201686969622819777830310582261166322483200*L2c^2*g*m3^2*q3*cos(3*q2) + 17460557183346545698151547444562661399079652704135839559607229703879098328849228408935000876377420456449480439313012018765437265738190719978163643572033012562452667009620508672*L2c^4*dq1*dq2*m3^2*sin(2*q2) - 16366650904031720666258732712053173388588947511254305666675659615767712301179616097820147082749410103553078950720036259987246738820348615065600*L2c^4*dq1*dq2*m3^2*sin(4*q2) + 142576269300693600582536612678133569327526742984707573942348050130712425605241941642656970931055044424419008090162852241563628091403242306730340477917467791313081879851886873721507444214988800*I1*dq1^2*m3*q3^2*sin(2*q2) + 534575386647866809923888251716055644260034267684826632640702746556313250175666863109111464447220197219317243920690759393186285089691429939160550340344032526336*I1*dq2^2*m3*q3^2*sin(2*q2) + 142576269300693600582536612678133569327526742984707573942348050130712425605241941642656970931055044424419008090162852241563628091403242306730340477917467791313081879851886873721507444214988800*I2*dq1^2*m3*q3^2*sin(2*q2) + 534575386647866809923888251716051635586705790768544672968142479067324076952501160836862326340642082260944186189685888309617854496216013803651386824404552908800*I2*dq2^2*m3*q3^2*sin(2*q2) + 142576269300693600582536612678133569327526742984707573942348050130712425605241941642656970931055044424419008090162852241563628091403242306730340477917467791313081879851886873721507444214988800*I3*dq1^2*m3*q3^2*sin(2*q2) + 534575386647866809923888251716051635586705790768544672968142479067324076952501160836862326340642082260944186189685888309617854496216013803651386824404552908800*I3*dq2^2*m3*q3^2*sin(2*q2) - 534575386647866809923888251716059652933362744601108592313263014045302423398832565381360602553798312177690301651695630476754715683166846074669713856283512143872*L2c*dq3^2*m3^2*q3*sin(2*q2) - 267287693323933404961944125858025817793352895384272336484071239533662038476250580418431163170321041130472093094842944154808927248108006901825693412202276454400*L2c*dq3^2*m3^2*q3*sin(4*q2) - 3207452319887200859543329510296321839540220175360113916826535676870911981384504071837921372363586838440784290331129943108412418757722331228435811494245756305408*L2c*g*m3^2*q3^2*sin(2*q2) - 3207452319887200859543329510296321839540220175360113916826535676870911981384504071837921372363586838440784290331129943108412418757722331228435811494245756305408*L2c^2*g*m3^2*q3*sin(2*q2) + 8730278591673272849075773722281379799492538447229918556001751011582445155280813515923397858116946046868155049866057223400321471260932028708938986059430530046410612362358816768*dq1*dq2*m3^2*q3^4*cos(3*q2) + 285152538601387201165073225356269276956600077436654843437702964479993218019077706309884832112828825112665495682075868679846938485480403509378632714001424759335929050007394880480860325080465408*dq2*dq3*m3^2*q3^3*cos(2*q2) - 267287693323933404961944125858026819961685014613342826402211306405909331782042005986493447696965569870065357527594161925701034896476860935702984291187146358784*dq2*dq3*m3^2*q3^3*cos(4*q2) - 34921114366693091396303094889125650131177386042685004293868700473189652020867330680605693553137372515249165132728104497694202962262868653263421754503410762459166825978796179456*I1*L2c*dq1*dq3*m3*sin(q2) - 34921114366693091396303094889125388264762921535154344154145307621433592805597826223403847598988412107800255927980477346730042250409003728136170200606178470311603157907328204800*I2*L2c*dq1*dq3*m3*sin(q2) + 2138301546591467239695553006864222577040137070739306530562810986225253000702667452436445857788880788877268975682763037572745140358765719756642201361376130105344*I2*L2c*dq2*dq3*m3*sin(q2) - 34921114366693091396303094889125388264762921535154344154145307621433592805597826223403847598988412107800255927980477346730042250409003728136170200606178470311603157907328204800*I3*L2c*dq1*dq3*m3*sin(q2) + 2138301546591467239695553006864222577040137070739306530562810986225253000702667452436445857788880788877268975682763037572745140358765719756642201361376130105344*I3*L2c*dq2*dq3*m3*sin(q2) - 34921114366693091396303094889125650131177386042685004293868700473189652020867330680605693553137372515249165132728104497694202962262868653263421754503410762459166825978796179456*I1*dq1*dq3*m3*q3*sin(q2) - 34921114366693091396303094889125388264762921535154344154145307621433592805597826223403847598988412107800255927980477346730042250409003728136170200606178470311603157907328204800*I2*dq1*dq3*m3*q3*sin(q2) + 2138301546591467239695553006864222577040137070739306530562810986225253000702667452436445857788880788877268975682763037572745140358765719756642201361376130105344*I2*dq2*dq3*m3*q3*sin(q2) - 34921114366693091396303094889125388264762921535154344154145307621433592805597826223403847598988412107800255927980477346730042250409003728136170200606178470311603157907328204800*I3*dq1*dq3*m3*q3*sin(q2) + 2138301546591467239695553006864222577040137070739306530562810986225253000702667452436445857788880788877268975682763037572745140358765719756642201361376130105344*I3*dq2*dq3*m3*q3*sin(q2) + 34921114366693091396303094889125519197970153788919674224007004046329780621123254063693591432467784187472620199464228893601285885043728114835755944237722120185642449449435267072*L2c*dq1*dq2*m3^2*q3^3*cos(3*q2) + 855457615804161603495219676068807830869800232309964530313108893439979654057233118929654496338486475337996487046227606039540815456441210528135898142004274278007787150022184641442580975241396224*L2c*dq2*dq3*m3^2*q3^2*cos(2*q2) + 855457615804161603495219676068807830869800232309964530313108893439979654057233118929654496338486475337996487046227606039540815456441210528135898142004274278007787150022184641442580975241396224*L2c^2*dq2*dq3*m3^2*q3*cos(2*q2) + 34921114366693091396303094889125519197970153788919674224007004046329780621123254063693591432467784187472620199464228893601285885043728114835755944237722120185642449449435267072*L2c^3*dq1*dq2*m3^2*q3*cos(3*q2) - 801863079971800214885832377574080459885055043840028479206633919217727995346126017959480343090896709610196072582782485777103104689430582807108952873561439076352*L2c*dq2*dq3*m3^2*q3^2*cos(4*q2) - 801863079971800214885832377574080459885055043840028479206633919217727995346126017959480343090896709610196072582782485777103104689430582807108952873561439076352*L2c^2*dq2*dq3*m3^2*q3*cos(4*q2) - 52381671550039637094454642333687493197711837160787530916840327514226493285876367723934849286254795058862202684953461887509446692003997396871879254664886303835772669959748976640*L2c^2*dq1*dq2*m3^2*q3^2*cos(q2) + 69842228733386182792606189778250645596318610816543358238428918815516393315396913635740003505509681825797921757252048075061749062952762879912654574288132050249810668038482034688*L2c*dq1*dq2*m3^2*q3^3*sin(2*q2) + 69842228733386182792606189778250645596318610816543358238428918815516393315396913635740003505509681825797921757252048075061749062952762879912654574288132050249810668038482034688*L2c^3*dq1*dq2*m3^2*q3*sin(2*q2) - 65466603616126882665034930848212693554355790045017222666702638463070849204718464391280588330997640414212315802880145039948986955281394460262400*L2c*dq1*dq2*m3^2*q3^3*sin(4*q2) - 65466603616126882665034930848212693554355790045017222666702638463070849204718464391280588330997640414212315802880145039948986955281394460262400*L2c^3*dq1*dq2*m3^2*q3*sin(4*q2) - 65466603616126882665034930848212939014803817376114300461488537240101862227301186906787741040177963466231281812888474308073036890917017866993664*I1*L2c*dq1*dq3*m3*cos(2*q2) - 1069150773295733619847776503432111288520068535369653265281405493112626500351333726218222928894440394438634487841381518786372570179382859878321100680688065052672*I1*L2c*dq2*dq3*m3*cos(2*q2) - 17460557183346545698151547444562759598985076894459837112003502023655811206616289226002385288031446155762355265177145461106061303167968095349897988777397308192692495971531096064*I2*L2c*dq1*dq3*m3*cos(2*q2) - 1069150773295733619847776503432107279846740058453371305608845225623637327128168023945973790787862279480261430110376647702804139585907443742811937164748585435136*I2*L2c*dq2*dq3*m3*cos(2*q2) - 17460557183346545698151547444562759598985076894459837112003502023655811206616289226002385288031446155762355265177145461106061303167968095349897988777397308192692495971531096064*I3*L2c*dq1*dq3*m3*cos(2*q2) - 1069150773295733619847776503432107279846740058453371305608845225623637327128168023945973790787862279480261430110376647702804139585907443742811937164748585435136*I3*L2c*dq2*dq3*m3*cos(2*q2) + 130933207232253765330069861696425878029607634752228600922977074480203724454602373813575482080355926932462563625776948616146073781834035733987328*I2*L2c^2*dq1*dq2*m3*cos(q2) + 130933207232253765330069861696425878029607634752228600922977074480203724454602373813575482080355926932462563625776948616146073781834035733987328*I3*L2c^2*dq1*dq2*m3*cos(q2) + 2138301546591467239695553006864214559693480116906742611217690451247274654256336047891947581575724558960522860220753295405608279171814887485623874329497170870272*I1*L2c*dq1^2*m3*q3*cos(q2) + 2138301546591467239695553006864214559693480116906742611217690451247274654256336047891947581575724558960522860220753295405608279171814887485623874329497170870272*I2*L2c*dq1^2*m3*q3*cos(q2) + 2138301546591467239695553006864222577040137070739306530562810986225253000702667452436445857788880788877268975682763037572745140358765719756642201361376130105344*I2*L2c*dq2^2*m3*q3*cos(q2) + 2138301546591467239695553006864214559693480116906742611217690451247274654256336047891947581575724558960522860220753295405608279171814887485623874329497170870272*I3*L2c*dq1^2*m3*q3*cos(q2) + 2138301546591467239695553006864222577040137070739306530562810986225253000702667452436445857788880788877268975682763037572745140358765719756642201361376130105344*I3*L2c*dq2^2*m3*q3*cos(q2) - 65466603616126882665034930848212939014803817376114300461488537240101862227301186906787741040177963466231281812888474308073036890917017866993664*I1*dq1*dq3*m3*q3*cos(2*q2) - 1069150773295733619847776503432111288520068535369653265281405493112626500351333726218222928894440394438634487841381518786372570179382859878321100680688065052672*I1*dq2*dq3*m3*q3*cos(2*q2) - 17460557183346545698151547444562759598985076894459837112003502023655811206616289226002385288031446155762355265177145461106061303167968095349897988777397308192692495971531096064*I2*dq1*dq3*m3*q3*cos(2*q2) - 1069150773295733619847776503432107279846740058453371305608845225623637327128168023945973790787862279480261430110376647702804139585907443742811937164748585435136*I2*dq2*dq3*m3*q3*cos(2*q2) - 17460557183346545698151547444562759598985076894459837112003502023655811206616289226002385288031446155762355265177145461106061303167968095349897988777397308192692495971531096064*I3*dq1*dq3*m3*q3*cos(2*q2) - 1069150773295733619847776503432107279846740058453371305608845225623637327128168023945973790787862279480261430110376647702804139585907443742811937164748585435136*I3*dq2*dq3*m3*q3*cos(2*q2) + 130933207232253765330069861696425878029607634752228600922977074480203724454602373813575482080355926932462563625776948616146073781834035733987328*I2*dq1*dq2*m3*q3^2*cos(q2) + 130933207232253765330069861696425878029607634752228600922977074480203724454602373813575482080355926932462563625776948616146073781834035733987328*I3*dq1*dq2*m3*q3^2*cos(q2) + 52381671550039637094454642333688278796955230683379511336010506069494670931684881095540387148701676281208930299196343340401928827565592172253633916356583180278463674174152900608*L2c^2*dq1*dq2*m3^2*q3^2*cos(3*q2) + 104763343100079274188909284667375968394477916224815037357643378223274589973095370453610005258264522738696882635878072112592623594429144319868981861432198075374716002057723052032*L2c^2*dq1*dq2*m3^2*q3^2*sin(2*q2) - 98199905424190323997552396272319040331533685067525834000053957694606273807077696586920882496496460621318473704320217559923480432922091690393600*L2c^2*dq1*dq2*m3^2*q3^2*sin(4*q2) + 17460557183346545698151547444562694132381460767577172077072653810716796402798913111701923799494206053900127963990238673365021125204501864068085100303089235155801578953664102400*I2*L2c^2*dq1*dq2*m3*sin(2*q2) + 17460557183346545698151547444562694132381460767577172077072653810716796402798913111701923799494206053900127963990238673365021125204501864068085100303089235155801578953664102400*I3*L2c^2*dq1*dq2*m3*sin(2*q2) + 285152538601387201165073225356267138655053485969415147884696100261424851210483883285313941862110088848838016180325704483127256182806484613460680955834935582626163759703773747443014888429977600*I1*L2c*dq1^2*m3*q3*sin(2*q2) + 1069150773295733619847776503432111288520068535369653265281405493112626500351333726218222928894440394438634487841381518786372570179382859878321100680688065052672*I1*L2c*dq2^2*m3*q3*sin(2*q2) + 285152538601387201165073225356267138655053485969415147884696100261424851210483883285313941862110088848838016180325704483127256182806484613460680955834935582626163759703773747443014888429977600*I2*L2c*dq1^2*m3*q3*sin(2*q2) + 1069150773295733619847776503432103271173411581537089345936284958134648153905002321673724652681284164521888372379371776619235708992432027607302773648809105817600*I2*L2c*dq2^2*m3*q3*sin(2*q2) + 285152538601387201165073225356267138655053485969415147884696100261424851210483883285313941862110088848838016180325704483127256182806484613460680955834935582626163759703773747443014888429977600*I3*L2c*dq1^2*m3*q3*sin(2*q2) + 1069150773295733619847776503432103271173411581537089345936284958134648153905002321673724652681284164521888372379371776619235708992432027607302773648809105817600*I3*L2c*dq2^2*m3*q3*sin(2*q2) - 34921114366693091396303094889124995465141224773858353944560218342817662190584245149289899524169863372574801789968974591672964461335998264581252836443257535890515113306499317760*L2c*dq1*dq2*m3^2*q3^3*cos(q2) - 34921114366693091396303094889124995465141224773858353944560218342817662190584245149289899524169863372574801789968974591672964461335998264581252836443257535890515113306499317760*L2c^3*dq1*dq2*m3^2*q3*cos(q2) + 17460557183346545698151547444562694132381460767577172077072653810716796402798913111701923799494206053900127963990238673365021125204501864068085100303089235155801578953664102400*I2*dq1*dq2*m3*q3^2*sin(2*q2) + 17460557183346545698151547444562694132381460767577172077072653810716796402798913111701923799494206053900127963990238673365021125204501864068085100303089235155801578953664102400*I3*dq1*dq2*m3*q3^2*sin(2*q2) + 261866414464507530660139723392851756059215269504457201845954148960407448909204747627150964160711853864925127251553897232292147563668071467974656*I2*L2c*dq1*dq2*m3*q3*cos(q2) + 261866414464507530660139723392851756059215269504457201845954148960407448909204747627150964160711853864925127251553897232292147563668071467974656*I3*L2c*dq1*dq2*m3*q3*cos(q2) + 34921114366693091396303094889125388264762921535154344154145307621433592805597826223403847598988412107800255927980477346730042250409003728136170200606178470311603157907328204800*I2*L2c*dq1*dq2*m3*q3*sin(2*q2) + 34921114366693091396303094889125388264762921535154344154145307621433592805597826223403847598988412107800255927980477346730042250409003728136170200606178470311603157907328204800*I3*L2c*dq1*dq2*m3*q3*sin(2*q2))/(6582018229284824168619876730229402019930943462534319453394436096*(43322963970637732180912721627235682866194329302747133987038743447103457934462900359999600095377180907771737671271930809827721216*I2^2 + 43322963970637732180912721627235682866194329302747133987038743447103457934462900359999600095377180907771737671271930809827721216*I3^2 + 43322963970637732180912721627235845301291901480585936367601611020049285245029261543204606702218980991476347154605394375403896832*I1*I2 + 43322963970637732180912721627235845301291901480585936367601611020049285245029261543204606702218980991476347154605394375403896832*I1*I3 + 86645927941275464361825443254471365732388658605494267974077486894206915868925800719999200190754361815543475342543861619655442432*I2*I3 + 43322963970637732180912721627236007736389473658424738748164478593604146622174390425578377248699105807418195778897268890088053089*L2c^4*m3^2*cos(q2)^2 - 162435097572177838802380562867572945827310566361183205006606841800083704609483333463565576175616*L2c^4*m3^2*cos(q2)^4 + 43322963970637732180912721627236007736389473658424738748164478593604146622174390425578377248699105807418195778897268890088053089*m3^2*q3^4*cos(q2)^2 - 162435097572177838802380562867572945827310566361183205006606841800083704609483333463565576175616*m3^2*q3^4*cos(q2)^4 + 43322963970637732180912721627236007736389473658424738748164478593604146622174390425578377248699105807418195778897268890088053089*I1*L2c^2*m3 + 43322963970637732180912721627236007736389473658424738748164478593604146622174390425578377248699105807418195778897268890088053089*I2*L2c^2*m3 + 43322963970637732180912721627236007736389473658424738748164478593604146622174390425578377248699105807418195778897268890088053089*I3*L2c^2*m3 + 43322963970637732180912721627236007736389473658424738748164478593604146622174390425578377248699105807418195778897268890088053089*I1*m3*q3^2 + 43322963970637732180912721627236007736389473658424738748164478593604146622174390425578377248699105807418195778897268890088053089*I2*m3*q3^2 + 43322963970637732180912721627236007736389473658424738748164478593604146622174390425578377248699105807418195778897268890088053089*I3*m3*q3^2 - 162435097572177838802380562867573554861377145128882373770546480124815941848624291874514684156257*I1*m3*q3^2*cos(q2)^2 + 43322963970637732180912721627235520431096757124908331606475875874157630623896539176794593488535380824067128187938467244251545600*I2*m3*q3^2*cos(q2)^2 + 43322963970637732180912721627235520431096757124908331606475875874157630623896539176794593488535380824067128187938467244251545600*I3*m3*q3^2*cos(q2)^2 + 173291855882550928723650886508944030945557894633698954992657914374416586488697561702313508994796423229672783115589075560352212356*L2c*m3^2*q3^3*cos(q2)^2 + 173291855882550928723650886508944030945557894633698954992657914374416586488697561702313508994796423229672783115589075560352212356*L2c^3*m3^2*q3*cos(q2)^2 - 649740390288711355209522251470291783309242265444732820026427367200334818437933333854262304702464*L2c*m3^2*q3^3*cos(q2)^4 - 649740390288711355209522251470291783309242265444732820026427367200334818437933333854262304702464*L2c^3*m3^2*q3*cos(q2)^4 + 86645927941275464361825443254472015472778947316849477496328957187208293244348780851156754497398211614836391557794537780176106178*I1*L2c*m3*q3 + 86645927941275464361825443254472015472778947316849477496328957187208293244348780851156754497398211614836391557794537780176106178*I2*L2c*m3*q3 + 86645927941275464361825443254472015472778947316849477496328957187208293244348780851156754497398211614836391557794537780176106178*I3*L2c*m3*q3 + 259937783823826393085476329763416046418336841950548432488986871561624879733046342553470263492194634844509174673383613340528318534*L2c^2*m3^2*q3^2*cos(q2)^2 - 974610585433067032814283377205437674963863398167099230039641050800502227656900000781393457053696*L2c^2*m3^2*q3^2*cos(q2)^4 - 162435097572177838802380562867573554861377145128882373770546480124815941848624291874514684156257*I1*L2c^2*m3*cos(q2)^2 + 43322963970637732180912721627235520431096757124908331606475875874157630623896539176794593488535380824067128187938467244251545600*I2*L2c^2*m3*cos(q2)^2 + 43322963970637732180912721627235520431096757124908331606475875874157630623896539176794593488535380824067128187938467244251545600*I3*L2c^2*m3*cos(q2)^2 - 324870195144355677604761125735147109722754290257764747541092960249631883697248583749029368312514*I1*L2c*m3*q3*cos(q2)^2 + 86645927941275464361825443254471040862193514249816663212951751748315261247793078353589186977070761648134256375876934488503091200*I2*L2c*m3*q3*cos(q2)^2 + 86645927941275464361825443254471040862193514249816663212951751748315261247793078353589186977070761648134256375876934488503091200*I3*L2c*m3*q3*cos(q2)^2)); 
    ddq3 = (162435097572177838802380562867572945827310566361183205006606841800083704609483333463565576175616*g*m3 - 43322963970637732180912721627235682866194329302747133987038743447103457934462900359999600095377180907771737671271930809827721216*tau3 - 21661481985318866090456360813618085085743522918131770564363673082970469933080991954807309957951290579442783060636160753278124032*dq1^2*m3*q3 - (86645927941275464361825443254471853037681375139010675115766089613653431867203651968782983950918086798894542933502663265491949921*dq2^2*m3*q3)/2 + 43322963970637732180912721627235682866194329302747133987038743447103457934462900359999600095377180907771737671271930809827721216*g*m3*sin(q2) - 21661481985318866090456360813618085085743522918131770564363673082970469933080991954807309957951290579442783060636160753278124032*L2c*dq1^2*m3 - (86645927941275464361825443254471853037681375139010675115766089613653431867203651968782983950918086798894542933502663265491949921*L2c*dq2^2*m3)/2 - 5305532915621760638932094989885589305198650351294141888575215604290738819910811175157743538537785994785012580352*dq1*dq2*m3*q3 - 21661481985318866090456360813617760215548378562454165803237937937078815311948269588397296744267690412033564093969233622125772800*L2c*dq1^2*m3*cos(2*q2) + (162435097572177838802380562867573554861377145128882373770546480124815941848624291874514684156257*L2c*dq2^2*m3*cos(2*q2))/2 - 21661481985318866090456360813617760215548378562454165803237937937078815311948269588397296744267690412033564093969233622125772800*dq1^2*m3*q3*cos(2*q2) + (162435097572177838802380562867573554861377145128882373770546480124815941848624291874514684156257*dq2^2*m3*q3*cos(2*q2))/2 + 324870195144355677604761125735145891654621132722366410013213683600167409218966666927131152351232*L2c*dq1^2*m3*sin(q2) + 162435097572177838802380562867572945827310566361183205006606841800083704609483333463565576175616*dq2*dq3*m3*sin(2*q2) - 5305532915621760638932094989885589305198650351294141888575215604290738819910811175157743538537785994785012580352*L2c*dq1*dq2*m3 + 324870195144355677604761125735145891654621132722366410013213683600167409218966666927131152351232*dq1^2*m3*q3*sin(q2) + 9946281115547779716645852274853036047668089532778274734818156495955070166237184*L2c*dq1*dq2*m3*cos(2*q2) + 9946281115547779716645852274853036047668089532778274734818156495955070166237184*dq1*dq2*m3*q3*cos(2*q2) + 5305532915621760638932094989885599251479765899073858534427490457326786488000343953432478356694281949855178817536*L2c*dq1*dq2*m3*sin(q2) + 5305532915621760638932094989885599251479765899073858534427490457326786488000343953432478356694281949855178817536*dq1*dq2*m3*q3*sin(q2))/(m3*(81217548786088919401190281433786472913655283180591602503303420900041852304741666731782788087808*cos(2*q2) - 43322963970637732180912721627235926518840687569505337557883044807131232966891209833975873945278205765565891037230537107299965281));    
    
    ddth = [ddq1 ddq2 ddq3]';
    
    % Numerical integration
    dth = dth + ddth*dt;
    th = th + dth*dt;
    
    ddth_out(i,:) = ddth;
    dth_out(i,:) = dth;
    th_out(i,:) = th;
    u_out(i,:) = u;
    
end

figure(1)
set(gcf,'position',[0 10 600 700])
subplot(3,1,1)
h1 = plot(time, th_out(:,1)*rad2deg,'k','linewidth',2);
hold on
h2 = plot(time, th_out(:,2)*rad2deg,'r','linewidth',2);
h3 = plot(time, ones(length(time),1)*th_d(1)*rad2deg,'k:','linewidth',1);
h4 = plot(time, ones(length(time),1)*th_d(2)*rad2deg,'r:','linewidth',1);
ylabel('Angle [Deg]')
legend([h1, h2, h3, h4], 'J1', 'J2', 'Desired J1', 'Desired J2')
set(gca,'fontsize',13)
subplot(3,1,2)
plot(time, dth_out(:,1)*rad2deg,'k','linewidth',2)
hold on
plot(time, dth_out(:,2)*rad2deg,'r','linewidth',2)
ylabel('Angular Velocity [Deg/s]')
set(gca,'fontsize',13)
subplot(3,1,3)
plot(time, ddth_out(:,1)*rad2deg,'k','linewidth',2)
hold on
plot(time, ddth_out(:,2)*rad2deg,'r','linewidth',2)
ylabel('Acceleration [Deg/s^2]')
xlabel('Time [Sec]')
set(gca,'fontsize',13)

figure(2)
set(gcf,'position',[0 10 600 700])
subplot(3,1,1)
h5 = plot(time, th_out(:,3),'b','linewidth',2);
hold on
h6 = plot(time, ones(length(time),1)*th_d(3),'b:','linewidth',1);
ylabel('Displacement [m]')
legend([h5, h6],'J3', 'Desired J3')
set(gca,'fontsize',13)
subplot(3,1,2)
plot(time, dth_out(:,3),'b','linewidth',2)
hold on
ylabel('Linear Velocity [m/s]')
set(gca,'fontsize',13)
subplot(3,1,3)
plot(time, ddth_out(:,3),'b','linewidth',2)
ylabel('Acceleration [m/s^2]')
xlabel('Time [Sec]')
set(gca,'fontsize',13)

figure(3)
subplot(2,1,1)
h10 = plot(time, u_out(:,1),'k','linewidth',2);
hold on
h11 = plot(time, u_out(:,2),'r','linewidth',2);
ylabel('Input Torque [Nm]')
xlabel('Time [Sec]')
legend([h10, h11],'Desired torque J1', 'Desired torque J2')
set(gca,'fontsize',13)

subplot(2,1,2)
h12 = plot(time, u_out(:,3),'b','linewidth',2);
ylabel('Input Force [N]')
xlabel('Time [Sec]')
legend([h12], 'Desired Force J3')
set(gca,'fontsize',13)

% Visualize Simulation with Forward Kinematics
step = 20;

% Camera View
az = 30;
el = 30;

% Origin
origin = [0 0 0]';
x_axis = [1 0 0]';
y_axis = [0 1 0]';
z_axis = [0 0 1]';

% Forward Kinematics
for i = 1:step:length(time)
    
    % Sinusoidal Input Joint Angle
    th1 = th_out(i,1);
    th2 = th_out(i,2);
    d3 = th_out(i,3);
    
    % Forward Kinematics using DH convention
    % DH parameter Ground 
    a0 = 0; alpha0 = 0; d0 = 0; q0 = 0;
    TG0 = DH(q0, d0, alpha0, a0);

    % DH parameter Link 1
    a1 = 0; alpha1 = 90*deg2rad; d1 = L1; q1 = th1;
    T01 = DH(q1, d1, alpha1, a1);

    % DH parameter Link 2
    a2 = 0; alpha2 = -90*deg2rad; d2 = 0; q2 = th2-90*deg2rad;
    T12 = DH(q2, d2, alpha2, a2);

    % DH parameter Link 3
    a3 = 0; alpha3 = 0; d3 = L2+d3; q3 = 0;
    T23 = DH(q3, d3, alpha3, a3);

    T01 = TG0*T01;
    T02 = T01*T12;
    T03 = T02*T23;

    % Position and axis infomation
    P0 = TG0(1:3,4);
    P1 = T01(1:3,4);
    P2 = T02(1:3,4);
    P3 = T03(1:3,4);

    figure(100)
    % Draw global coordinate
    plot3(origin(1),origin(2),origin(3),'ro','linewidth',5)
    hold on
    line([origin(1) x_axis(1)],[origin(2) x_axis(2)],[origin(3) x_axis(3)], 'color', 'r', 'linewidth', 2)
    line([origin(1) y_axis(1)],[origin(2) y_axis(2)],[origin(3) y_axis(3)], 'color', 'g', 'linewidth', 2)
    line([origin(1) z_axis(1)],[origin(2) z_axis(2)],[origin(3) z_axis(3)], 'color', 'b', 'linewidth', 2)

    % P0 from given theta
    plot3(P0(1),P0(2),P0(3),'ro','linewidth',2)
    line([origin(1) P0(1)],[origin(2) P0(2)],[origin(3) P0(3)], 'color', 'k', 'linewidth', 2)
    % P1 from given theta
    plot3(P1(1),P1(2),P1(3),'ko','linewidth',2)
    line([P0(1) P1(1)],[P0(2) P1(2)],[P0(3) P1(3)], 'color', 'k', 'linewidth', 2)
    % P2 from given theta
    plot3(P2(1),P2(2),P2(3),'ko','linewidth',2)
    line([P1(1) P2(1)],[P1(2) P2(2)],[P1(3) P2(3)], 'color', 'k', 'linewidth', 2)
    % P3 from given theta
    plot3(P3(1),P3(2),P3(3),'ko','linewidth',2)
    line([P2(1) P3(1)],[P2(2) P3(2)],[P2(3) P3(3)], 'color', 'k', 'linewidth', 2)

    xlabel('x- axis','fontsize',13)
    ylabel('y- axis','fontsize',13)
    zlabel('z- axis','fontsize',13)
    title('3DoF RRP Manipulator')
    set(gca,'fontsize',13)
    axis equal
%     axis([-2 2 -2 2 0 3])
    grid on
    view(az, el)
    pause(0.001)
    hold off

end
